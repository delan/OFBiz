<?xml version="1.0" encoding="UTF-8"?>
<!--
 *  Copyright (c) 2004 The Open For Business Project - www.ofbiz.org
 *
 *  Permission is hereby granted, free of charge, to any person obtaining a
 *  copy of this software and associated documentation files (the "Software"),
 *  to deal in the Software without restriction, including without limitation
 *  the rights to use, copy, modify, merge, publish, distribute, sublicense,
 *  and/or sell copies of the Software, and to permit persons to whom the
 *  Software is furnished to do so, subject to the following conditions:
 *
 *  The above copyright notice and this permission notice shall be included
 *  in all copies or substantial portions of the Software.
 *
 *  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
 *  OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 *  MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
 *  IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY
 *  CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT
 *  OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR
 *  THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 *
 *  $Id: CMSScreens.xml 7870 2006-06-27 05:41:26Z jonesde $
-->

<screens xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
        xsi:noNamespaceSchemaLocation="http://www.ofbiz.org/dtds/widget-screen.xsd">

	<screen name="CMSContentFind">
		<section>
			<condition>
				<if-has-permission permission="CONTENTMGR" action="UPDATE"/>
			</condition>
		<actions>
            <set field="title" value="CMS Content Find Page"/>
            <set field="entityName" value="ContentAssocDataResourceViewFrom"/>
            <service service-name="urlEncodeArgs" result-map-name="result">
                <field-map env-name="requestParameters" field-name="mapIn"/>
            </service>
            <set field="viewIndex" from-field="requestParameters.VIEW_INDEX" type="Integer" default-value="0"/>
            <set field="viewSize" from-field="requestParameters.VIEW_SIZE" type="Integer" default-value="20"/>
            <set field="currentCMSMenuItemName" value="contentfind" to-scope="user"/>
		</actions>
                  <widgets>
                       <decorator-screen name="commonCmsDecorator" location="${parameters.mainDecoratorLocation}">
                         <decorator-section name="body">
                           <include-form name="findContent" location="component://content/webapp/content/cms/CMSForms.xml" />
                           <include-form name="listFindContent" location="component://content/webapp/content/cms/CMSForms.xml" />
                          </decorator-section>
                        </decorator-screen>
                  </widgets>
		</section>
	</screen>

	<screen name="CMSContentEdit">
		<section>
			<condition>
				<if-has-permission permission="CONTENTMGR" action="UPDATE"/>
			</condition>
		<actions>
		    <script location="component://content/widget/getMenuContext.bsh"/>
                    <set field="title" value="CMS Content Edit Page"/>
                    <set field="titleProperty" value="PageTitleEditContent"/>
			<entity-one entity-name="Content" value-name="currentValue">
				<field-map field-name="contentId" env-name="parameters.contentId"/>
			</entity-one>
			<entity-one entity-name="ElectronicText" value-name="electronicText">
				<field-map field-name="dataResourceId" env-name="parameters.drDataResourceId"/>
			</entity-one>
			<set field="textData" from-field="electronicText.textData"/>
			<set field="contentId" from-field="currentValue.contentId"/>
			<set field="dataResourceId" from-field="parameters.drDataResourceId"/>
            <set field="rootForumId" value="WebStoreFORUM" />
            <set field="rootForumId2" value="WebStoreCONTENT" />
		    <script location="component://content/widget/cms/featureprep.bsh"/>
            <set field="menuContext.contentTarget" value="CMSContentEdit?contentId=${contentId}&amp;drDataResourceId=${dataResourceId}"/>
		</actions>
                  <widgets>
                       <decorator-screen name="commonCmsDecorator" location="${parameters.mainDecoratorLocation}">
                         <decorator-section name="body">
                    		<platform-specific>
                         		<html>
                             		<html-template location="component://content/webapp/content/cms/CMSContentEdit.ftl"/>
                         		</html>
                    		</platform-specific>
                          </decorator-section>
                        </decorator-screen>
                  </widgets>
		</section>
	</screen>
	
	<screen name="CMSContentAdd">
		<section>
			<condition>
				<if-has-permission permission="CONTENTMGR" action="CREATE"/>
			</condition>
		<actions>
		    <script location="component://content/widget/getMenuContext.bsh"/>
                    <set field="title" value="CMS Content Edit Page"/>
                    <set field="titleProperty" value="PageTitleEditContent"/>
		</actions>
                  <widgets>
                       <decorator-screen name="commonCmsDecorator" location="${parameters.mainDecoratorLocation}">
                         <decorator-section name="body">
                           <include-form name="AddContent" location="component://content/webapp/content/cms/CMSForms.xml" />
                          </decorator-section>
                        </decorator-screen>
                  </widgets>
		</section>
	</screen>
	
	<screen name="EditAddContent">
		<section>
			<condition>
				<if-has-permission permission="CONTENTMGR" action="UPDATE"/>
			</condition>
			<actions>
            	<set field="title" value="CMS Content Edit Page"/>
                <set field="entityOperation" value="_UPDATE"/>
                <set field="targetOperation" value="CONTENT_UPDATE|CONTENT_CREATE|CONTENT_CREATE_SUB"/>
                <set field="requiredRoles" value="OWNER|BLOG_AUTHOR|BLOG_EDITOR|BLOG_ADMIN|BLOG_PUBLISHER"/>
                <set field="contentPurposeTypeId" value="ARTICLE"/>
                <set field="MASTER_contentId" from-field="parameters.MASTER_contentId" default-value="${parameters.contentId}"/>
                <set field="MASTER_drDataResourceId" from-field="parameters.MASTER_drDataResourceId" default-value="${parameters.drDataResourceId}"/>
                <set field="MASTER_caContentIdTo" from-field="parameters.MASTER_caContentIdTo" default-value="${parameters.caContentIdTo}"/>
                <set field="MASTER_caContentId" from-field="parameters.MASTER_caContentId" default-value="${parameters.caContentIdFrom}"/>
                <set field="MASTER_caContentAssocTypeId" from-field="parameters.MASTER_caContentAssocTypeId" default-value="${parameters.caContentAssocTypeId}"/>
                <set field="MASTER_caFromDate" from-field="parameters.MASTER_caFromDate" default-value="${parameters.caFromDate}"/>
                
                <set field="contentId" from-field="MASTER_contentId" />
                <set field="drDataResourceId" from-field="MASTER_drDataResourceId" />
                <set field="caContentIdTo" from-field="MASTER_caContentIdTo" />
                <set field="caContentId" from-field="MASTER_caContentId" />
                <set field="caContentAssocTypeId" from-field="MASTER_caContentAssocTypeId" />
                <set field="caFromDate" from-field="MASTER_caFromDate" />
                
                
			    <script location="component://content/widget/cms/cmseditaddprep.bsh"/>
                <set field="currentCMSMenuItemName" value="EditAddContent" to-scope="user"/>
                <set field="enableEdit" value="true" />
			</actions>
	    	<widgets>
                       <decorator-screen name="commonCmsDecorator" location="${parameters.mainDecoratorLocation}">
                         <decorator-section name="body">
                           <link  text="Goto Find" target="CMSContentFind?VIEW_INDEX=${CMSContentFindViewIndex}&amp;${CMSContentFindQueryString}" style="tabletext"/>
                           <include-form name="EditAddContentStuff" location="component://content/webapp/content/cms/CMSForms.xml" />
                           <content content-id="${contentId}" enable-edit-name="notfound"  edit-request="EditAddSubContent?MASTER_contentId=${MASTER_contentId}&amp;MASTER_caContentIdTo=${MASTER_caContentIdTo}&amp;MASTER_caContentAssocTypeId=${MASTER_caContentAssocTypeId}&amp;MASTER_caFromDate=${MASTER_caFromDate}&amp;MASTER_drDataResourceId=${MASTER_drDataResourceId}&amp;caContentIdTo=${caContentIdTo}"/>
                          </decorator-section>
                        </decorator-screen>
	    	</widgets>
		</section>
	</screen>
	
	<screen name="EditAddSubContent">
		<section>
			<condition>
				<if-has-permission permission="CONTENTMGR" action="UPDATE"/>
			</condition>
			<actions>
            	<set field="title" value="CMS Content Edit Page"/>
                <set field="entityOperation" value="_UPDATE"/>
                <set field="targetOperation" value="CONTENT_UPDATE|CONTENT_CREATE|CONTENT_CREATE_SUB"/>
                <set field="requiredRoles" value="OWNER|BLOG_AUTHOR|BLOG_EDITOR|BLOG_ADMIN|BLOG_PUBLISHER"/>
                <set field="contentPurposeTypeId" value="ARTICLE"/>
                <set field="MASTER_contentId" from-field="parameters.MASTER_contentId" />
                <set field="MASTER_drDataResourceId" from-field="parameters.MASTER_drDataResourceId" />
                <set field="MASTER_caContentIdTo" from-field="parameters.MASTER_caContentIdTo" />
                <set field="MASTER_caContentId" from-field="parameters.MASTER_caContentId" />
                <set field="MASTER_caContentAssocTypeId" from-field="parameters.MASTER_caContentAssocTypeId" />
                <set field="MASTER_caFromDate" from-field="parameters.MASTER_caFromDate" />
                
                <set field="caContentIdTo" from-field="parameters.contentId"/>
                <set field="caMapKey" from-field="parameters.mapKey"/>
                
			    <script location="component://content/widget/cms/cmseditaddprep.bsh"/>
                <set field="currentCMSMenuItemName" value="EditAddContent" to-scope="user"/>
			</actions>
	    	<widgets>
	    	    <decorator-screen name="commonCmsDecorator" location="${parameters.mainDecoratorLocation}">
	    	        <decorator-section name="body">
	    	            <link  text="Goto Find" target="CMSContentFind?VIEW_INDEX=${CMSContentFindViewIndex}&amp;${CMSContentFindQueryString}" style="tabletext"/>
	    	            <include-form name="EditAddSubContentStuff" location="component://content/webapp/content/cms/CMSForms.xml" />
	    	        </decorator-section>
	    	    </decorator-screen>
	    	</widgets>
		</section>
	</screen>
	
	<screen name="AdminSearch">
		<section>
			<condition>
				<if-has-permission permission="CONTENTMGR" action="UPDATE"/>
			</condition>
		<actions>
		    <script location="component://content/widget/getMenuContext.bsh"/>
		    <script location="component://content/widget/cms/advancedsearchprep.bsh"/>
		    <script location="component://content/widget/cms/search.bsh"/>
		    <set field="title" value="CMS Search Page"/>
		    <set field="titleProperty" value="PageTitleSearchContent"/>
		</actions>
		    <widgets>
		        <decorator-screen name="commonCmsDecorator" location="${parameters.mainDecoratorLocation}">
		            <decorator-section name="body">
		                <platform-specific>
		                    <html>
		                        <html-template location="component://content/webapp/content/cms/AdminSearch.ftl"/>
		                    </html>
		                </platform-specific>
		                <include-form name="searchList" location="component://content/webapp/content/cms/CMSForms.xml" />
		            </decorator-section>
		        </decorator-screen>
		    </widgets>
		</section>
	</screen>

	
	<screen name="AdminIndex">
		<section>
		    <condition>
		        <if-has-permission permission="CONTENTMGR" action="UPDATE"/>
		    </condition>
		    <actions>
		        <script location="component://content/widget/getMenuContext.bsh"/>
		        <set field="title" value="CMS Search Page"/>
		        <set field="titleProperty" value="PageTitleSearchContent"/>
		    </actions>
		    <widgets>
		        <decorator-screen name="commonCmsDecorator" location="${parameters.mainDecoratorLocation}">
		            <decorator-section name="body">
		                <include-form name="AdminIndex" location="component://content/webapp/content/cms/CMSForms.xml" />
		                <include-form name="AdminIndexAll" location="component://content/webapp/content/cms/CMSForms.xml" />
		            </decorator-section>
		        </decorator-screen>
		    </widgets>
		</section>
	</screen>
	
	<screen name="CMSSites">
		<section>
		    <condition>
		        <if-has-permission permission="CONTENTMGR" action="UPDATE"/>
		    </condition>
		    <actions>
		        <script location="component://content/widget/getMenuContext.bsh"/>
		        <set field="title" value="CMS Search Page"/>
		        <set field="titleProperty" value="PageTitleSearchContent"/>
		        <set field="forumId" from-field="parameters.contentId"/>
		        <set field="defaultSiteId" value="WebStoreFORUM"/>
		        <script location="component://content/widget/cms/userpermprep.bsh"/>
		    </actions>
		    <widgets>
		        <decorator-screen name="commonCmsDecorator" location="${parameters.mainDecoratorLocation}">
		            <decorator-section name="body">
		                <platform-specific>
		                    <html>
		                        <html-template location="component://content/webapp/content/cms/CMSSites.ftl"/>
		                    </html>
		                </platform-specific>
		            </decorator-section>
		        </decorator-screen>
		    </widgets>
		</section>
	</screen>


	<screen name="addSubSite">
		<section>
		    <condition>
		        <if-has-permission permission="CONTENTMGR" action="UPDATE"/>
		    </condition>
		    <actions>
		        <script location="component://content/widget/getMenuContext.bsh"/>
		        <set field="title" value="Add SubSite"/>
		        <set field="titleProperty" value="PageTitleSearchContent"/>
		    </actions>
		    <widgets>
		        <decorator-screen name="commonCmsDecorator" location="${parameters.mainDecoratorLocation}">
		            <decorator-section name="body">
		                <platform-specific>
		                    <html>
		                        <html-template location="component://content/webapp/content/cms/addSubSite.ftl"/>
		                    </html>
		                </platform-specific>
		            </decorator-section>
		        </decorator-screen>
		    </widgets>
		</section>
	</screen>
	<screen name="TestPermission">
		<section>
		    <condition>
		        <if-has-permission permission="CONTENTMGR" action="ADMIN"/>
		    </condition>
		    <actions>
		        <script location="component://content/widget/getMenuContext.bsh"/>
		        <set field="title" value="Test Permission"/>
		        <set field="titleProperty" value="Test Permission"/>
		    </actions>
		    <widgets>
		        <decorator-screen name="commonCmsDecorator" location="${parameters.mainDecoratorLocation}">
		            <decorator-section name="body">
		                <include-form name="TestPermission" location="component://content/webapp/content/cms/CMSForms.xml" />
		            </decorator-section>
		        </decorator-screen>
		    </widgets>
		</section>
	</screen>
</screens>

