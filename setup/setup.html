<html>
<head>
<!--  $Id$ -->
<title>The Open For Business Project: General Setup</title>
</head>

<body>

<h2 align="center">The Open For Business Project: General Setup</h2>

<br>
  Written By: David E. Jones and Andy Zeneski<br>
  Email: <a href="mailto:jonesde@ofbiz.org">jonesde@ofbiz.org</a> or <a href="mailto:jaz@zsolv.com">jaz@zsolv.com</a> <br>
  Open For Business Site: <a href="http://www.ofbiz.org/">http://www.ofbiz.org</a> <br>
<A href="http://sf.net/projects/ofbiz"> <IMG src="http://sourceforge.net/sflogo.php?group_id=27173" border="0" alt="SourceForge Logo"></A> <br>
  Founders and Lead Architects: David E. Jones &amp; Andy Zeneski <br>
  Last Updated: January 14, 2002 <br>
<h3 align="left"><a name="Table of Contents">Table of Contents</a></h3>
<ul>
  <li><a href="#Introduction">Introduction</a></li>
  <li><a href="#Quick_Easy_Setup">Quick &amp; Easy Setup</a></li>
  <li><a href="#External_Packages_Setup">External Packages Setup</a></li>
  <li><a href="#Paths">Paths</a></li>
  <li><a href="#File_Locations">File Locations and Building</a></li>
  <li><a href="#Running">Running</a></li>
  <li><a href="#Database_Setup">Database Setup</a></li>
  <li><a href="#DeployOptions">Alternative Deployment Options</a></li>
</ul>

<hr>
<h3><a name="Introduction">Introduction</a></h3>
<hr>
<p>This document describes an initial setup process and configuration options 
for the Open For Business Project.</p>
<br>

<hr>
<h3><a name="Quick_Easy_Setup">Quick &amp; Easy Setup</a></h3>
<hr>

<p>You can get up and running quickly by downloading the OFBiz Complete
distribution and following some simple instructions. For more
options and explanations, see the rest of this document.</p>
<ol>
  <li>Download and install the Java 2 v1.3 or later JDK from <a href='java.sun.com'>Sun's Java site</a>, and make sure your JAVA_HOME environment variable is set</li>
  <li>Download the OFBiz Complete archive and unzip it in the directory of your choice.
    This should create three directories: <b>ofbiz</b>,
    <b>data</b>, &amp; <b>catalina</b> (note that &quot;catalina&quot; is the code name, and
    semi-official name, for Jakarta Tomcat 4.0). The ofbiz directory created will be the OFBIZ_HOME.</li>
  <li>Start Catalina by running <b>&quot;catalina/bin/ofbiz.bat run&quot;</b> for Windows,
    or <b>&quot;catalina/bin/ofbiz.sh run&quot;</b> for Linux/Unix.</li>
  <li>Open a browser and go to <b><a href='http://127.0.0.1:8080/ecommerce'>http://127.0.0.1:8080/ecommerce</a></b> for the ecommerce application or
      <b><a href='http://127.0.0.1:8080/webtools'>http://127.0.0.1:8080/webtools</a></b> for the WebTools application or
      <b><a href='http://127.0.0.1:8080/catalog'>http://127.0.0.1:8080/catalog</a></b> for the Catalog Manager application.</li>
  <li>Have fun with it! You are running on a Java database, which isn't the best for development or deployment, but it's great for a demo...</li>
  <li>For more detailed options and configuration information, read on!</li>
</ol>

<hr>
<h3><a name="External_Packages_Setup">External Packages Setup</a></h3>
<hr>

<p>You will also need the Java 2 version 1.3 or 1.4 JDK (or just the JRE) from <a href="http://java.sun.com" target="_blank">java.sun.com</a>,
as can be expected.</p>

<p>Open For Business can be run with either a simple servlet engine alone (like
Tomcat) or with a full J2EE container (like Weblogic or JBoss &amp; Tomcat together). This
is accomplished through the entity engine which can run straight to JDBC or
through an EJB container. A full J2EE application server is also useful for services other than the basic
EJB container, such as JNDI, connection pooling,
various resource and configuration management conveniences and so forth. Many
other J2EE application servers are available for these sorts of features, and
Open For Business should be easily adaptable to various ones.</p>

<p>Tomcat 4.0 is the current default application server for Open For Business.
At the moment the EJB components are optional and simply provide deployment
flexibility, so an EJB container is not needed. In the future we will likely need 
JMS and EJB services provided by
an application like JBoss, but for now we will keep distributions as simple as
possible. JTA (distributed transaction) support is currently done with Tyrex from Exolab, 
but could also be provided by JBoss or another J2EE application server.</p>

<p>Tomcat can be downloaded at <a href="http://jakarta.apache.org/site/binindex.html">jakarta.apache.org/site/binindex.html</a>,
and you will generally want the latest version of the Tomcat 4
series. The latest version of OFBiz has been tested on Tomcat 4.0.1. If
you download an OFBiz package with these included, you of course don't need to
download them again, and you don't have to worry about copying the configuration
files later on. It should pretty much run in place.</p>
<p>You can download JBoss, a complete J2EE application server from <a href="http://sf.net/projects/jboss" target="_blank">sf.net/projects/jboss</a>,
you will generally want the most recent version. </p>

<p>Things will be much easier if you have Ant installed, which can also be
downloaded from the <a href="http://jakarta.apache.org/site/binindex.html">jakarta.apache.org</a> site listed above.
Instructions are available on the Ant site for installing the
application. Just make sure that 'ant' is on the system path and can be run from
the command line.</p>

<p>To run the Ant scripts, and Tomcat, make sure the various
environment variables are set as described below (JAVA_HOME, ANT_HOME, CATALINA_HOME, and
yes, even OFBIZ_HOME).</p>

<hr>
<h3><a name="Paths">Paths</a></h3>
<hr>
<p>The last step is to make sure the directories are correct, especially the JDK path. This is
done by making sure the various environment variables are set (JAVA_HOME,
ANT_HOME, CATALINA_HOME, OFBIZ_HOME). These directories
are setup as follows:</p>

<table cellpadding='2' cellspacing='0' border='1'>
  <tr>
    <td><b>Environment Name</b></td>
    <td><b>Example</b></td>
    <td><b>Description</b></td>
  </tr>
  <tr><td>JAVA_HOME</td><td>/usr/local/java or c:\jdk1.3.1_02</td>
    <td>where the Java 2 SDK is installed</td></tr>
  <tr><td>ANT_HOME</td><td>/usr/local/ant or c:\tools\ant</td>
    <td>where Ant is installed, should contain bin, docs, lib, etc</td></tr>
  <tr><td>CATALINA_HOME</td><td>/ofbiz/work/catalina</td>
    <td>where Tomcat4/Catalina is installed, should contain bin, lib, common, work, and so forth</td></tr>
  <tr><td>OFBIZ_HOME</td><td>/ofbiz/work/ofbiz</td>
    <td>where OFBiz is installed; contains all of the OFBiz CVS modules like core, commonapp, webtools, lib, ecommerce, and so forth</td></tr>
</table>
<br>
<hr>
<h3><a name="File_Locations">File Locations and Building</a></h3>
<hr>

<p>Catalina comes with a number of jar files in place, but some jar and other files 
need to be copied into the catalina directory from the ofbiz directories. This can be done
most easily by making sure the environment variables are all set, then going to the
OFBIZ_HOME directory and running "ant install" to copy the 3rd party jars and server.xml file
and just plain "ant" to build and deploy the OFBiz jar and configuration files. </p>

<p>If you have just checked out the OFBiz modules from CVS you will beed to copy the Ant 
build.xml file from OFBIZ_HOME/setup/ofbiz/build.xml to OFBIZ_HOME. All of the jar files needed
to build OFBiz are included in the 'lib' module. Some of these need to be copied to
the catalina/lib and catalina/common/lib directories, but not all. Some are only
included to make it easier to build the project.</p>

<p>Here is a list of all of the files, their original locations, and where
in the catalina directory they need be copied to.</p>

<h4>3rd Party Libraries</h4>
<table cellpadding='2' cellspacing='0' border='1'>
  <tr>
    <td><b>Filename</b></td>
    <td><b>Original Location</b></td>
    <td><b>Destination Location</b></td>
  </tr>
  <tr><td>castor-0.9.3.9.jar</td><td>ofbiz/lib/common</td><td>catalina/common/lib</td></tr>
  <tr><td>tyrex-0.9.8.5.jar</td><td>ofbiz/lib/common</td><td>catalina/common/lib</td></tr>
  <tr><td>tyrex-0.9.7.0.jar</td><td>catalina/common/lib</td><td>REMOVE (comes with catalina)</td></tr>
  <tr><td>ots-jts_1.0.jar</td><td>ofbiz/lib/common</td><td>catalina/common/lib</td></tr>
  <tr><td>log4j.jar</td><td>ofbiz/lib/common</td><td>catalina/common/lib</td></tr>
  <tr><td>axis.jar</td><td>ofbiz/lib/share</td><td>catalina/lib</td></tr>
  <tr><td>clutil.jar</td><td>ofbiz/lib/share</td><td>catalina/lib</td></tr>
  <tr><td>wsdl4j.jar</td><td>ofbiz/lib/share</td><td>catalina/lib</td></tr>
  <tr><td>bsh-1.2b3.jar</td><td>ofbiz/lib/share</td><td>catalina/lib</td></tr>
  <tr><td>jakarta-oro-2.0.4.jar</td><td>ofbiz/lib/share</td><td>catalina/lib</td></tr>
</table>

<h4>JDBC Drivers</h4>
<p>JDBC Drivers need to be put in <b>catalina/common/lib</b> so that Tyrex or Poolman
can find them. If you need any additional ones put them there.</p>
<table cellpadding='2' cellspacing='0' border='1'>
  <tr>
    <td><b>Filename</b></td>
    <td><b>Original Location</b></td>
    <td><b>Destination Location</b></td>
  </tr>
  <tr><td>hsqldb.jar</td><td>ofbiz/lib/common</td><td>catalina/common/lib</td></tr>
  <tr><td>jdbc7.1-1.3.jar</td><td>ofbiz/lib/common</td><td>catalina/common/lib</td></tr>
  <tr><td>mm.mysql-2.0.8-bin.jar</td><td>ofbiz/lib/common</td><td>catalina/common/lib</td></tr>
</table>

<h4>OFBiz Libraries</h4>
<table cellpadding='2' cellspacing='0' border='1'>
  <tr>
    <td><b>Filename</b></td>
    <td><b>Original Location</b></td>
    <td><b>Destination Location</b></td>
  </tr>
  <tr><td>ofbcore-share.jar</td><td>ofbiz/core/lib</td><td>catalina/lib</td></tr>
  <tr><td>ofbcore-rules.jar</td><td>ofbiz/core/lib</td><td>catalina/lib</td></tr>
  <tr><td>ofbcore-workflow.jar</td><td>ofbiz/core/lib</td><td>catalina/lib</td></tr>
  <tr><td>ofbcommonapp.jar</td><td>ofbiz/commonapp/lib</td><td>catalina/lib</td></tr>
</table>

<h4>OFBiz Configuration Files</h4>
<table cellpadding='2' cellspacing='0' border='1'>
  <tr>
    <td><b>Filename</b></td>
    <td><b>Original Location</b></td>
    <td><b>Destination Location</b></td>
  </tr>
  <tr><td>cache.properties</td><td>ofbiz/commonapp/etc</td><td>catalina/classes</td></tr>
  <tr><td>debug.properties</td><td>ofbiz/commonapp/etc</td><td>catalina/classes</td></tr>
  <tr><td>entityengine.xml</td><td>ofbiz/commonapp/etc</td><td>catalina/classes</td></tr>
  <tr><td>localdtds.properties</td><td>ofbiz/commonapp/etc</td><td>catalina/classes</td></tr>
  <tr><td>security.properties</td><td>ofbiz/commonapp/etc</td><td>catalina/classes</td></tr>
  <tr><td>serverstats.properties</td><td>ofbiz/commonapp/etc</td><td>catalina/classes</td></tr>
  <tr><td>servicesengine.properties</td><td>ofbiz/commonapp/etc</td><td>catalina/classes</td></tr>
  <tr><td>tyrexdomain.xml</td><td>ofbiz/commonapp/etc</td><td>catalina/classes</td></tr>
</table>

<p>NOTE: Poolman is not being used right now, instead we are using Tyrex for
connection pooling and JTA support. The config files have been left in place just
in case anyone wants to change the configuration to use it (ie entityengine.xml).</p>

<hr>
<h3><a name="Running">Running</a></h3>
<hr>
<p>To setup the path to the OFBiz directory and pass it into the Java application
the -D argument on the Java command line must be used. To make this easier ofbiz.sh and ofbiz.bat have
been provided which set some things up before calling catalina.sh or catalina.bat, respectively.
These ofbiz scripts should be put in <b>catalina/bin</b>, and you can
use the run, start, stop, etc. parameters on the command line.</p>

<p>The default data can be loaded by going to the following URL: <a href="http://localhost:8080/commonapp/control/main">http://localhost:8080/commonapp/control/main</a>,
and then click on the link for data loading, or go to <a href="http://localhost:8080/commonapp/control/main">http://localhost:8080/commonapp/control/install</a>
directly. Since there can be multiple servers depending on the name of the
entity group, you must enter the entity group name so the JSP knows which files
to load to which server, as setup in the entityengine.xml file. This JSP loads all .SQL files in the directories specified in the
entityengine.xml file for the given group name. The default group name for all
of the default entities in OFBiz is &quot;org.ofbiz.commonapp&quot;, which you
will notice pre-populated in the form on the install page. Just click on
&quot;Load Data&quot;, and after reviewing the summary of what it will do, click
on &quot;Yes, Load Now&quot;, and be patient as the data is loaded into you
database.</p>

<p>That data loader can load XML Entity Engine files or SQL files.
For SQL files the data loader page expects ';' separated SQL INSERT statements. These
INSERT statements should list all of the column names for each value. INSERT
statements are generally pretty generic, so this should work for most databases.
These statements are run through JDBC, and use the JDBC data mappings for
genericity.</p>

<p>Go to <a href="http://localhost:8080/webtools/control/main">http://localhost:8080/webtools/</a>
for the Web Tools. 
For secured areas of the site, the default admin
account information is in an XML data loader file. The default is 'admin' for
the username, and 'ofbiz' for the password. Be patient when you hit each page
for the first time, they all need to be compiled when it is run initially.</p>

<p>The other applications can be reached at similar looking URLs. For instance,
the ecommerce application can be accessed at <a href="http://localhost:8080/ecommerce/control/main">http://localhost:8080/ecommerce/</a>.
<hr>
<h3><a name="Database_Setup">Database Setup</a></h3>
<hr>

<p>Database setup is done in the entityengine.xml file. There are many
options there which are described in the Entity Engine Guide.</p>

<p>The OFBiz Complete archive comes with Hypersonic SQL, a Java database that
runs in memory. This database is good for demonstration purposes because it is
easy to setup and use. It is not meant to handle large data sets and does not
provide the same performance or scalability that a major database would.</p>

<p>There are many open source databases that will scale well and deliver good performance.
The two most popular are MySQL and PostgreSQL. Postgres is a very full featured
database with transaction support, stored procedures, et cetera. MySQL is known
for performing very well but the transaction support is limited (and improving) and
there is no support for stored procedures. The stored procedures issue is not
a big deal for OFBiz as it stands now because they are not used, but transaction
support is VERY important for production business systems. Another good open source
option is SAP DB, which deserves special mention. SAP decided to start encouraging
users to use commercial databases instead of their own and open sourced their
database, SAP DB. While maybe not as good as Oracle or other commercial DBs it
has many features and performs well.</p>

<p>Commercial databases are also supported. If you have database licenses for other
needs, or have major in-house familiarity with and support for a certain commercial
database, then there is no reason not to take advantage of that. OFBiz has been tested
with Oracle and should work fine with any database that has a JDBC driver.</p>

<p>You can download MySQL from <a href="http://www.mysql.com/" target="_blank">www.mysql.com</a>,
get the most recent stable version. You will also need the MySQL JDBC driver, get the most recent stable version
from Mark Matthews on his SourceForge site at <a href="http://mmmysql.sourceforge.net/" target="_blank">mmmysql.sourceforge.net</a>.
If you download the jar files there, you can't just put it in <b>catalina/lib</b>
because it has all of the source and docs and is not
just the driver jar. Open up the jar and get the jar in the base path of the
archive and use that, it is the real binary jar driver file.</p>

<p>There is no need to run any SQL scripts to create the tables or populate them
with the default data. The entity engine can create missing tables or fields
when the server starts up and does so if the appropriate property is set in the
entityengine.xml file. This is the file that configures the servers for the
entity engine.</p>
<p>For the table creation routine to work properly, the field types must be set
up by specifying the corresponding fieldtypeXXX.xml (where XXX is the database
name) file for the server in the entityengine.xml file. These fieldtypeXXX.xml
files are located in the <b>ofbiz/commonapp/entitydef</b> directory,
along with the entitymodel*.xml files which contain database independent entity
definitions.</p>
<p>Default data can be loaded automatically once the server has been started by
going to a JSP, which is listed below in the Running section.</p>

<hr>
<h3><a name="DeployOptions">Alternative Deployment Options</a></h3>
<hr>
<p>Future releases of The Open For Business Project will support alternative deployment 
options, for use with application servers other then Jakarta Tomcat and JBoss. 
The <i>webapp</i> directory in each module is a fully self sufficient web application. 
Each of these may be packaged into a WAR file and deployed normally. Please 
keep in mind the OFBiz required libraries must be in the global classpath. An 
alternative method of deploying with Catalina would be not to modify the server.xml 
file, but instead place the required files in the /lib and /classes directory 
as described above and deploy the WAR files in the /webapps directory.</p>

<p>Sample configuration files and start scripts for various app servers are 
available in the setup module of OFBiz (see ofbiz/setup in the distro). Open For
Business uses a few primary components of J2EE and needs a container for these
components. The components needed for OFBiz include Servlet 2.3, JSP 1.2, and
a JTA implementation with a JDBC XA Wrapper and Connection Pool.</p>

<p>The following configurations have been tested and are included:</p>
<table border='1' cellpadding='2' cellspacing='0'>
    <tr>
        <td><b>Servlet/JSP&nbsp;Container</b></td>
        <td><b>JTA&nbsp;&amp;&nbsp;XA&nbsp;JDBC&nbsp;Container</b></td>
        <td><b>Comments</b></td>
    </tr>
    <tr>
        <td><a href='http://jakarta.apache.org'>Tomcat 4.0.1 - Catalina</a></td>
        <td><a href='http://www.exolab.org'>Tyrex 0.9.8.5</a></td>
        <td>Default config; freely available; comparatively slow</td>
    </tr>
    <tr>
        <td><a href='http://jetty.mortbay.com'>Jetty 4</a></td>
        <td><a href='http://www.exolab.org'>Tyrex 0.9.8.5</a></td>
        <td>Freely available; also slow, Jetty appears to run even slower than Tomcat4</td>
    </tr>
    <tr>
        <td><a href='http://jakarta.apache.org'>Tomcat 4.0.1 - Catalina</a></td>
        <td><a href='http://www.jboss.org'>JBoss 2.4.4</a></td>
        <td>Freely available; same speed at Catalina/Tyrex, but can interoperate 
            with other JBoss resources like EJBs, etc</td>
    </tr>
    <tr>
        <td><a href='http://www.caucho.com'>Caucho Resin 2.0.5</a></td>
        <td><a href='http://www.exolab.org'>Tyrex 0.9.8.5</a></td>
        <td>Resin $500/server, Tyrex free; runs MUCH faster than Tomcat or Jetty</td>
    </tr>
    <tr>
        <td><a href='http://www.orionserver.com'>Orion 1.5.3</a></td>
        <td><a href='http://www.orionserver.com'>Orion 1.5.3</a> or 
            <a href='http://www.exolab.org'>Tyrex 0.9.8.5</a></td>
        <td>Orion $1,500/server; OFBiz can interoperate with other Orion resources;
            the fastest and best scaling container we have tested</td>
    </tr>
    <tr>
        <td><a href='http://www.bea.com'>BEA Weblogic 6.1</a></td>
        <td><a href='http://www.bea.com'>BEA Weblogic 6.1</a></td>
        <td>Weblogic ~$10,000/CPU (used to be, I don't know how much it is now), 
            OFBiz can interoperate with other Weblogic resources, but is slower 
            than Resin or Orion</td>
    </tr>
</table>

<p>Full testing and deployment instructions for WebSphere, iPlanet,
JRun, ServletExec, and others are forthcoming in future releases. If you are interested 
in helping with this please contact one of the project administrators.</p>

<p>&nbsp;</p>
</body>

</html>
