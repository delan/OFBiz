<html>
<head>
<title>The Open For Business Project: General Setup</title>
</head>

<body>

<h2 align="center">The Open For Business Project: General Setup</h2>

<br>Written By: David E. Jones
<br>Email: <a href="mailto:jonesde@ofbiz.org">jonesde@ofbiz.org</a>
<br>Open For Business Site: <a href="http://www.ofbiz.org/">http://www.ofbiz.org</a>
<br>Last Updated: May 23, 2001

<h3 align="left"><a name="Table of Contents">Table of Contents</a></h3>
<ul>
  <li><a href="#Introduction">Introduction</a></li>
  <li><a href="#Quick &amp; Easy Setup">Quick &amp; Easy Setup</a></li>
  <li><a href="#MySQL Setup">MySQL Setup (or other database)</a></li>
  <li><a href="#JBoss &amp; Tomcat Setup">JBoss &amp; Tomcat (and Ant and
    PoolMan) Setup</a></li>
  <li><a href="#OFBiz Setup">OFBiz Setup</a></li>
  <li><a href="#Running">Running</a></li>
</ul>

<h3><a name="Introduction">Introduction</a></h3>
<p>This document describes an initial setup process for the Open For Business Project.</p>

<h3><a name="Quick &amp; Easy Setup">Quick &amp; Easy Setup</a></h3>

<p>You can get up and running quickly by downloading the OFBiz &amp;
Tomcat4/PoolMan distribution and following some simple instructions. For more
options and explanations, see the rest of this document.</p>
<ol>
  <li>Download the OFBiz &amp; Tomcat4/PoolMan archive and unzip it in <b>/ofbiz/work</b>.
    This should create two directories under <b>/ofbiz/work</b>: <b>ofbiz</b>
    &amp; <b>catalina</b> (note that &quot;catalina&quot; is the code name, and
    semi-official name, for Jakarta Tomcat 4.0)</li>
  <li>If MySQL is not setup on the target computer, download and install it as
    instructed below. Don't worry about the JDBC driver, it is already in place
    in the OFBiz &amp; Tomcat4 archive. For this simple setup, just make sure
    there is a MySQL database on <b>localhost</b> called &quot;<b>ofbiz</b>&quot;,
    and make sure it is accessible through the username &quot;<b>mysqldb</b>&quot;
    and the password &quot;<b>mysqldb</b>&quot;.</li>
  <li>Start Tomcat 4 by executing the <b>startup.bat</b> or <b>startup.sh</b>
    script in <b>/ofbiz/work/catalina/bin</b>.</li>
</ol>

<h3><a name="MySQL Setup">MySQL Setup</a></h3>
<p>MySQL is the default database for ofbiz. It will run with any database that
JBoss supports with Container Managed Persistence, which is a lot of databases.
For other databases, the SQL table creation and data loading files will have to
be changed, and the jaws.xml deployment descriptor may have to be changed, but
that is all.</p>
<p>You can download MySQL from <a href="http://www.mysql.com" target="_blank">www.mysql.com</a>,
get the most recent stable version.</p>
<p>You will also need the MySQL JDBC driver, get the most recent stable version
from Mark Matthews on his SourceForge site at <a href="http://mmmysql.sourceforge.net/">http://mmmysql.sourceforge.net/</a>.
If you download the jar files there, you can't just put it in <b>catalina/lib</b>
or <b>jboss/lib/ext</b> because it has all of the source and docs and is not
just the driver jar. Open up the jar and get the jar in the base path of the
archive and use that, it is the real binary jar driver file.</p>
<p>To use the default settings in the ofbiz configuration files, create a
database called &quot;ofbiz&quot; and start the MySQL server with a username of
&quot;mysqldb&quot; and a password of &quot;mysqldb&quot;. If you use different
settings, change them in the jboss.jcml file in the jboss/conf/ofbiz directory
(after you copy it there, of course, see below).</p>
<p>The JDBC driver mm.mysql-2.0.4-bin.jar is used most easily by putting it in
the jboss/lib/ext directory, after you have installed JBoss. Or, put it on the
JBOSS_CLASSPATH explicitly in your startup script.</p>
<p>There is no need to run any SQL scripts to create the tables or populate them
with the default data. The entity engine can create missing tables or fields
when the server starts up and does so if the appropriate property is set in the
servers.properties file. This is the file that configures the servers for the
entity engine.</p>
<p>For the table creation routine to work properly, the field types must be set
up by specifying the corresponding fieldtypeXXX.xml (where XXX is the database
name) file for the server in the servers.properties file. These fieldtypeXXX.xml
files are located in the <b>&lt;main&gt;/ofbiz/commonapp/entitydef </b>directory,
along with the entitymodel.xml file which contains database independent entity
definitions.</p>
<p>Default data can be loaded automatically once the server has been started by
going to a JSP, which is listed below in the Running section.&nbsp;</p>

<h3><a name="JBoss &amp; Tomcat Setup">JBoss &amp; Tomcat Setup</a></h3>
<p>Open For Business can be run with either a simple servlet engine alone (like
Tomcat) or with a full J2EE container (like JBoss &amp; Tomcat together). This
is accomplished through the entity engine which can run straight to JDBC or
through an EJB container. JBoss is also useful for services other than the basic
Entity Bean containment, such as session beans, JNDI, connection pooling,
various resource and configuration management conveniences and so forth. Many
other J2EE application servers are available for these sorts of features, and
Open For Business should be easily adaptable to various ones.</p>
<p>Tomcat 4.0 is the current default application server for Open For Business.
At the moment the EJB components are optional and simply provide deployment
flexibility, so an EJB container is not needed. Tomcat 4.0 has a number of the
nice services mentioned above that are part of JBoss, and meets our needs in
most cases. In the future we will likely need JMS and EJB services provided by
an application like JBoss, but for now we will keep distributions as simple as
possible. Build and deployment scripts are still included for JBoss deployment
in the ant build.xml file. Note that there are a few changes in the Servlet 2.3
and JSP 1.2 specifications that required minor modifications in the OFBiz code
as we upgraded to Tomcat 4.0 and started using the new APIs. These should be
pretty easy to see if you compile with the Tomcat 3.X jar files because certain
fields in the new API will not be found.</p>
<p> The default servlet
container running with JBoss is Tomcat, but Jetty could easily be used instead.
A sample configuration file for Tomcat is included, but the only things in there
are the webapp contexts to mount. An application server other than JBoss could
be used fairly easily by changing the EJB deployment descriptors and re-creating the EJB JAR file.
Everything in ofbiz is standard J2EE so there shouldn't be many problems with
this.</p>
<p>You can download JBoss-Tomcat from <a href="http://sf.net/projects/jboss" target="_blank">sf.net/projects/jboss</a>,
you will generally want the most recent version. Tomcat without JBoss can be downloaded at <a href="http://jakarta.apache.org/site/binindex.html">jakarta.apache.org/site/binindex.html</a>,
and there again you will generally want the latest version of the Tomcat 4
series. The latest version of ofbiz has been tested on Tomcat 4.0. If
you download an OFBiz package with these included, you of course don't need to
download them again, and you don't have to worry about copying the configuration
files later on. It should pretty much run in place.</p>
<p>Since Tomcat does not come with a database connection pool utility (as far as
I can tell), we also recommend the use of PoolMan for database connection
pooling. PoolMan can be downloaded at <a href="http://www.codestudio.com/">www.codestudio.com</a>.
Configuration for PoolMan for OFBiz is included with the project.&nbsp; There
are really only two files: <b>jndi.properties</b> &amp; <b>poolman.xml</b>, and
they need to be on the global classpath (ie in <b>catalina/classes</b>), they
are in <b>ofbiz/commonapp/etc</b>. The default <b>ofbiz/build.xml</b> ant script
will do this, of course the CATALINA_HOME environment variable must be set.
There are also two jar files from the PoolMan distribution that need to be moved
from poolman/lib to tomcat/lib, or placed on the classpath in some other way.
These two files are <b>poolman.jar</b> and <b>xerces.jar</b>. Hopefully in the
future PoolMan will use the standard JAXP libraries and no longer need
xerces.jar, but for now, oh well.</p>
<p>Things will be much simpler if you have Ant installed, which can also be
downloaded from the jakarta.apache.org site listed above where Tomcat is
also available. Instructions are available on the Ant site for installing the
application. Just make sure that 'ant' is on the system path and can be run from
the command line.</p>
<p>To run the Ant scripts, and JBoss or Tomcat, make sure the various
environment variables are set (JAVA_HOME, ANT_HOME, CATALINA_HOME, JBOSS_HOME
(optional), TOMCAT_HOME (optional), and
yes, even OFBIZ_HOME).</p>
<p>You will also need the Java 2 version 1.3 or 1.4 JDK (or just the JRE) from <a href="http://java.sun.com" target="_blank">java.sun.com</a>,
as can be expected.</p>

<h3><a name="OFBiz Setup">OFBiz Setup</a></h3>

<p>The easiest way to install OFBiz is to put everything in the default path of <b>/ofbiz/work</b>,
which will be referred to as the <b>&lt;main&gt;</b> directory in this section.
There is really only one file that has hard paths in it, and everything else is
relative. That file in the distribution is <b>ofbiz/commonapp/etc/servers.properties</b>.
When you are done with this section just replace all instances of &quot;<b>/ofbiz/work</b>&quot;
with whatever root, or <b>&lt;main&gt;</b>,&nbsp; path you use.</p>
<p><b>USING JBoss/Tomcat</b>: In the JBoss/Tomcat zip file there are two main directories: <b>jboss</b> and
<b>tomcat</b>. Unzip the JBoss/Tomcat ZIP file to the <b>&lt;main&gt;</b>
directory. With the default path you will have a <b>/ofbiz/work/jboss</b>
directory and a <b>/ofbiz/work/tomcat</b> directory.</p>
<p><b>USING Tomcat 4 (catalina)</b>: The Tomcat 4 archive contains a folder
called something like &quot;jakarta-tomcat-4.0&quot;. Move that folder to the
above mentioned <b>&lt;main&gt;</b> directory, and rename it from &quot;jakarta-tomcat-4.0&quot;
to &quot;catalina&quot;. With the default path you will have a <b>/ofbiz/work/catalina</b>
directory.</p>
<p>Unzip the ofbiz zip file and move the <b>ofbiz</b> directory to the <b>&lt;main&gt;</b>
directory, so that it is a
sibling of the <b>catalina</b> or <b>jboss</b> and <b>tomcat</b>
 directories, ie <b>&lt;main&gt;/ofbiz</b>.</p>
<p>The setup files are all in the 'setup' module, in <b>&lt;main&gt;/ofbiz/setup</b>. This setup
folder replicates the structure of the <b>&lt;main&gt;</b> directory, the one that
jboss,
tomcat, and ofbiz go under as described above. Moving the configuration files
can be done manually, or with the ant build script in <b>&lt;main&gt;/ofbiz/setup/ofbiz/build.xml</b>.
Simply copy that build file into &lt;main&gt;/ofbiz and then in that directory
run 'ant install'. That ant script can also be used to build all of the modules
in ofbiz by simply running 'ant'. The next two paragraphs explain how to manually
put the catalina or jboss &amp; tomcat configuration files in place.</p>
<p><b>USING JBoss/Tomcat:</b> Create the JBoss ofbiz conf directory by copying the <b>jboss/conf/tomcat</b>
directory, making a <b>jboss/conf/ofbiz</b> directory. Move the default ofbiz <b>jboss.jcml
and jboss.conf </b>files to the new ofbiz conf directory from <b>ofbiz/setup/jboss/conf/ofbiz/</b>,
replacing the existing files. Also copy the startup scripts (<b>ofbiz.bat</b>
and <b>ofbiz.sh</b>) to <b>jboss/bin</b> from <b>ofbiz/setup/jboss/bin</b>. Modify the Tomcat default configuration by copying the <b>server.xml</b> file
to <b>tomcat/conf</b> from <b>ofbiz/setup/tomcat/conf</b>.</p>
<p><b>USING Tomcat 4 (catalina)</b>: copy the server.xml file from <b>ofbiz/setup/catalina/conf/server.xml</b>
to <b>catalina/conf/server.xml</b>. As usual, you may want to create a backup
copy of the <b>server.xml</b> file in <b>catalina/conf</b> before writing over
it.</p>
<p>Remember to move the JDBC driver(s) to <b>catalina/lib</b> or <b>jboss/lib/ext</b>.</p>
<h3><a name="Running">Running</a></h3>

<p>The last step is to make sure the directories are correct, especially the JDK path. This is
done by making sure the various environment variables are set (JAVA_HOME,
ANT_HOME, CATALINA_HOME or JBOSS_HOME &amp; TOMCAT_HOME, and yes, even
OFBIZ_HOME). These directories
are setup as follows:</p>
<ul>
  <li>JAVA_HOME=&lt;wherever Java is installed...&gt;</li>
  <li>ANT_HOME=&lt;wherver Ant is installed, should be the parent directory of
    'bin' where the 'ant' scripts live</li>
  <li>(optional) JBOSS_HOME=<b>&lt;main&gt;/jboss</b></li>
  <li>(optional) TOMCAT_HOME=<b>&lt;main&gt;/tomcat</b></li>
  <li>CATALINA_HOME=<b>&lt;main&gt;/catalina</b></li>
  <li>OFBIZ_HOME=<b>&lt;main&gt;/ofbiz</b></li>
</ul>
<p><b>USING JBoss/Tomcat:</b> You should now be able to run the <b>&lt;main&gt;/</b><b>jboss/bin/ofbiz.bat</b> (for Windows) or
<b>&lt;main&gt;/</b><b>jboss/bin/ofbiz.sh</b> (for Unix).</p>
<p><b>USING Tomcat 4 (catalina)</b>: Start tomcat/catalina however you prefer to
do it. The startup &amp; shutdown scripts are in <b>catalina/bin</b>, or you can
use the catalina.bat or catalina.sh scripts with the run, start, stop, etc.
parameters on the command line.</p>
<p>The default data can be loaded by going to the following URL: <a href="http://localhost:8080/commonapp/control/main">http://localhost:8080/commonapp/control/main</a>,
and then click on the link for data loading, or go to <a href="http://localhost:8080/commonapp/control/main">http://localhost:8080/commonapp/control/install</a>
directly. Since there can be multiple servers depending on the name of the
entity group, you must enter the entity group name so the JSP knows which files
to load to which server, as setup in the servers.properties file. This JSP loads all .SQL files in the directories specified in the
servers.properties file for the given group name. The default group name for all
of the default entities in ofbiz is &quot;org.ofbiz.commonapp&quot;, which you
will notice pre-populated in the form on the install page. Just click on
&quot;Load Data&quot;, and after reviewing the summary of what it will do, click
on &quot;Yes, Load Now&quot;, and be patient as the data is loaded into you
database.</p>
<p>The data loader page expects ';' separated SQL INSERT statements. These
INSERT statements should list all of the column names for each value. INSERT
statements are generally pretty generic, so this should work for most databases.
These statements are run through JDBC, and use the JDBC data mappings for
genericity.</p>
<p>To access the site, go to <a href="http://localhost:8080/commonapp/control/main">http://localhost:8080/commonapp/control/main</a>
for the Common Application Components, or the entity oriented administration
tools. Although it has been deprecated, you may go to <a href="http://localhost:8080/entitygen/entitygen.jsp">http://localhost:8080/entitygen/entitygen.jsp</a>
for the Entity Code Generator. For secured areas of the site, the default admin
account information is in the SQL data loader file. The default is 'admin' for
the username, and 'ofbiz' for the password. Be patient when you hit each page
for the first time, they all need to be compiled when it is run freshly.</p>
<p>The other applications can be reached at similar looking URLs. For instance,
the ecommerce application can be accessed at <a href="http://localhost:8080/commonapp/control/main">http://localhost:8080/ecommerce/control/main</a>,
or since it has an index.jsp that forwards for convenience, you can go to <a href="http://localhost:8080/commonapp/control/main">http://localhost:8080/ecommerce</a>.</p>
<p>&nbsp;</p>

</body>

</html>
