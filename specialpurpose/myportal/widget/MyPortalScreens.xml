<?xml version="1.0" encoding="UTF-8"?>
<!--
Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements.  See the NOTICE file
distributed with this work for additional information
regarding copyright ownership.  The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License.  You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied.  See the License for the
specific language governing permissions and limitations
under the License.
-->

<screens xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
        xsi:noNamespaceSchemaLocation="http://ofbiz.apache.org/dtds/widget-screen.xsd">
        <screen name="newEvent">
        <section>
            <actions>
                <set field="portalPageId" from-field="parameters.portalPageId" default-value="parameters.portalPageId"/>
                <set field="headerItem" from-field="parameters.portalPageId"/>
            </actions>
            <widgets>
                <section>
                    <widgets>
                        <decorator-screen name="main-decorator"
                            location="${parameters.mainDecoratorLocation}">
                            <decorator-section name="body">
                                <screenlet>
                                    <include-form name="newEvent"
                                        location="component://myportal/widget/MyPortalForms.xml" />
                                </screenlet>
                            </decorator-section>
                        </decorator-screen>
                    </widgets>
                </section>
            </widgets>
        </section>
    </screen>
    <screen name="MyTimesheet">
        <section>
            <actions>
                <set field="headerItem" value="myTimesheet"/>
                <set field="portalPageId" value="parameters.portalPageId"/>
                <script location="component://projectmgr/webapp/projectmgr/WEB-INF/actions/EditWeekTimesheet.groovy"/>
            </actions>
            <widgets>
                <section>
                    <condition>
                        <if-has-permission permission="PROJECTMGR" action="_VIEW"/>
                    </condition>
                    <widgets>
                        <screenlet title="${uiLabelMap.PageTitleCurrentTimesheet} ${uiLabelMap.CommonNbr} ${timesheet.timesheetId} ${uiLabelMap.ProjectMgrWeek}: ${weekNumber} ${uiLabelMap.CommonFrom} ${bsh:timesheet.get(&quot;fromDate&quot;).toString().substring(0,10)} ${uiLabelMap.CommonTo} ${bsh:timesheet.get(&quot;thruDate&quot;).toString().substring(0,10)}"
                            navigation-menu-name="MyTimesheetMenu" collapsible="true" name="timesheet">
                            <include-menu name="MyTimesheetMenu" location="component://myportal/widget/MyPortalMenus.xml"/>
                            <section>
                                <condition>
                                    <if-compare field="timesheet.statusId" operator="equals" value="TIMESHEET_COMPLETED"/>
                                </condition>          
                                <widgets>
                                    <include-form name="WeekTimesheet" location="component://myportal/widget/MyPortalForms.xml"/>
                                </widgets>
                                <fail-widgets>
                                    <include-form name="EditWeekTimesheet" location="component://myportal/widget/MyPortalForms.xml"/>
                                </fail-widgets>
                            </section>
                        </screenlet>
                    </widgets>
                    <fail-widgets>
                        <screenlet title="${uiLabelMap.PageTitleCurrentTimesheet} ${uiLabelMap.CommonNbr} ${timesheet.timesheetId} ${uiLabelMap.ProjectMgrWeek}: ${weekNumber} ${uiLabelMap.CommonFrom} ${bsh:timesheet.get(&quot;fromDate&quot;).toString().substring(0,10)} ${uiLabelMap.CommonTo} ${bsh:timesheet.get(&quot;thruDate&quot;).toString().substring(0,10)}"
                            collapsible="true" name="timesheet">
                            <section>
                                <condition>
                                    <if-compare field="timesheet.statusId" operator="equals" value="TIMESHEET_COMPLETED"/>
                                </condition>          
                                <widgets>
                                    <include-form name="WeekTimesheet" location="component://myportal/widget/MyPortalForms.xml"/>
                                </widgets>
                                <fail-widgets>
                                    <include-form name="EditWeekTimesheet" location="component://myportal/widget/MyPortalForms.xml"/>
                                </fail-widgets>
                            </section>
                        </screenlet>
                    </fail-widgets>
                </section>
            </widgets>
        </section>
    </screen>
    <screen name="MyTasks">
        <section>
            <actions>
                <set field="portalPageId" value="myTasks"/>
                <entity-and entity-name="WorkEffortAndPartyAssign"
                    list="tasks" filter-by-date="true">
                    <field-map field-name="partyId" from-field="userLogin.partyId" />
                    <field-map field-name="workEffortTypeId" value="TASK" />
                    <field-map field-name="currentStatusId" value="PTS_CREATED" />
                </entity-and>
            </actions>
            <widgets>
                <section>
                    <condition>
                        <if-has-permission permission="PROJECTMGR"
                            action="_VIEW" />
                    </condition>
                    <widgets>
                        <screenlet title="${uiLabelMap.PageTitleTaskAssignedToMe}"
                            name="mytasks" collapsible="true" navigation-menu-name="MyTasksMenu">
                            <include-menu name="MyTasksMenu"
                                location="component://myportal/widget/MyPortalMenus.xml" />
                            <section>
                                <condition>
                                    <not>
                                        <if-empty field="tasks" />
                                    </not>
                                </condition>
                                <widgets>
                                    <include-form name="MyTasks"
                                        location="component://myportal/widget/MyPortalForms.xml" />
                                </widgets>
                                <fail-widgets>
                                    <container>
                                        <label style="h3" text="${uiLabelMap.ProjectMgrTaskNoOpen1}"></label>
                                    </container>
                                    <container>
                                        <label style="h3" text="${uiLabelMap.ProjectMgrTaskNoOpen2}"></label>
                                    </container>
                                </fail-widgets>
                            </section>
                        </screenlet>
                    </widgets>
                    <fail-widgets>
                        <screenlet title="${uiLabelMap.PageTitleTaskAssignedToMe}"
                            name="mytasks" collapsible="true">
                            <section>
                                <condition>
                                    <not>
                                        <if-empty field="tasks" />
                                    </not>
                                </condition>
                                <widgets>
                                    <include-form name="MyTasks"
                                        location="component://myportal/widget/MyPortalForms.xml" />
                                </widgets>
                                <fail-widgets>
                                    <container>
                                        <label style="h3" text="${uiLabelMap.ProjectMgrTaskNoOpen1}"></label>
                                    </container>
                                    <container>
                                        <label style="h3" text="${uiLabelMap.ProjectMgrTaskNoOpen2}"></label>
                                    </container>
                                </fail-widgets>
                            </section>
                        </screenlet>
                    </fail-widgets>
                </section>
            </widgets>
        </section>
    </screen>

    <screen name="MyCompanyComms">
        <section>
            <actions>
                <set field="portalPageId" from-field="parameters.portalPageId"/>
            </actions>
            <widgets>
                <screenlet title="${uiLabelMap.MyPortalCompanyEvents}" navigation-menu-name="MyCompanyCommsMenu" name="companyEvents" collapsible="true">
                    <include-menu name="MyCompanyCommsMenu" location="component://myportal/widget/MyPortalMenus.xml"/>
                    <include-form name="MyCompanyComms" location="component://myportal/widget/MyPortalForms.xml"/>
                </screenlet>
            </widgets>
        </section>
    </screen>
    <screen name="MyCommunications">
        <section>
            <actions>
                <set field="partyId" from-field="userLogin.partyId" />
                <set field="portalPageId" value="myCommunications"/>
            </actions>
            <widgets>
                <include-screen name="Communications"/>
            </widgets>
        </section>    
    </screen>
    <screen name="Communications">
        <section>
            <actions>
                <set field="all" from-field="parameters.all"/>
                <entity-condition entity-name="CommunicationEventAndRole"
                    list="commEvents">
                    <condition-list combine="and">
                        <condition-expr field-name="statusId" operator="not-equals"
                            value="COM_UNKNOWN_PARTY" />
                        <condition-expr field-name="statusId" operator="not-equals"
                            value="COM_PENDING" />
                        <condition-expr field-name="partyId" operator="equals"
                            value="${partyId}" />
                        <condition-expr field-name="roleStatusId"
                                operator="not-equals" value="COM_ROLE_COMPLETED" ignore="${all}" />
                    </condition-list>
                    <order-by field-name="-datetimeStarted" />
                </entity-condition>
                <entity-condition entity-name="CommunicationEventAndRole"
                    list="commEventsUnknown">
                    <condition-list combine="and">
                        <condition-expr field-name="statusId" operator="equals"
                            value="COM_UNKNOWN_PARTY" />
                        <condition-expr field-name="roleStatusId" operator="not-equals"
                            value="COM_ROLE_COMPLETED" />
                        <condition-expr field-name="partyId" operator="equals"
                            value="${partyId}" />
                    </condition-list>
                    <order-by field-name="-datetimeStarted" />
                </entity-condition>
                <entity-condition entity-name="CommunicationEventAndRole" list="commEventDraft">
                    <condition-list combine="and">
                        <condition-expr field-name="statusId" operator="equals" 
                            value="COM_PENDING"/>
                        <condition-expr field-name="partyId" operator="equals" 
                            value="${partyId}"/>                        
                    </condition-list>
                    <order-by field-name="-datetimeStarted" />
                </entity-condition>
                <entity-one entity-name="PartyNameView" value-field="partyName">
                    <field-map field-name="partyId" from-field="partyId"/>
                </entity-one>
            </actions>
            <widgets>
                <screenlet title="${uiLabelMap.MyPortalCommunicationsOfParty}: ${partyName.firstName} ${partyName.middleName} ${partyName.lastName} ${partyName.groupName} [${partyId}] "
                    navigation-menu-name="communicationsMenu" navigation-form-name="ListPartyCommEvents"
                    name="myComms">
                    <include-menu name="communicationsMenu"
                        location="component://myportal/widget/MyPortalMenus.xml" />
                    <section>
                        <condition>
                            <not>
                                <if-empty field="commEventsUnknown" />
                            </not>
                        </condition>
                        <widgets>
                            <label style="h2" text="${uiLabelMap.MyPortalEmailsFromUnknownOrigin}"></label>
                            <include-form
                                location="component://myportal/widget/MyPortalForms.xml"
                                name="ListMyUnknownPartyEmails" />
                        </widgets>
                    </section>
                    <label style="h2" text="${uiLabelMap.MyPortalEmailsFromKnownOrigin}"></label>
                    <include-form name="ListPartyCommEvents"
                        location="component://myportal/widget/MyPortalForms.xml" />
                    <section>
                        <condition>
                            <not>
                                <if-empty field="commEventDraft" />
                            </not>
                        </condition>
                        <widgets>
                            <label style="h2" text="${uiLabelMap.MyPageDraftEmails}"></label>
                            <include-form
                                location="component://myportal/widget/MyPortalForms.xml"
                                name="ListDraftEmails" />
                        </widgets>
                    </section>
                </screenlet>
            </widgets>
        </section>
    </screen>
    <screen name="OtherCommunications">
        <section>
            <actions>
                <set field="portalPageId" value="otherCommunications"/>
                <entity-and list="emailOwners" entity-name="PartyRelationship" filter-by-date="true">
                    <field-map field-name="partyIdFrom" value="${userLogin.partyId}" />
                    <field-map field-name="roleTypeIdFrom" value="EMAIL_ADMIN" />
                </entity-and>
            </actions>
            <widgets>
                <iterate-section entry="emailOwner" list="emailOwners">
                    <section>
                        <actions>
                            <set field="partyId" from-field="emailOwner.partyIdTo" />
                        </actions>
                        <widgets>
                            <include-screen name="Communications"/>
                        </widgets>
                    </section>
                </iterate-section>
            </widgets>
        </section>
    </screen>
    <screen name="ViewCommunicationEvent">
        <section>
            <actions>
                <set field="portalPageId" value="${parameters.portalPageId}"/>
                <set field="titleProperty" value="PageTitleViewCommunication" />
                <set field="tabButtonItem" value="OverView" />
                <set field="parentCommEventId" from-field="parameters.parentCommEventId" />
                <entity-one entity-name="CommunicationEvent" value-field="communicationEvent" />
                <set field="headerItem" from-field="parameters.portalPageId" />
            </actions>
            <widgets>
                <decorator-screen name="CommonCommunicationEventDecorator"
                    location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                        <container style="lefthalf">
                            <section>
                                <widgets>
                                    <label style="h1"
                                        text="${uiLabelMap.MyPortalCommunicationEventId} ${parameters.communicationEventId}"></label>
                                    <include-screen name="commEvent" 
                                            location="component://party/widget/partymgr/CommunicationScreens.xml" />
                                </widgets>
                            </section>
                            <section>
                                <condition>
                                    <not>
                                        <if-empty field="communicationEvent.parentCommEventId" />
                                    </not>
                                </condition>
                                <actions>
                                    <set field="parent" value="${uiLabelMap.CommonParent}"/>
                                    <entity-one entity-name="CommunicationEvent"
                                        value-field="communicationEvent">
                                        <field-map field-name="communicationEventId"
                                            from-field="communicationEvent.parentCommEventId" />
                                    </entity-one>
                                    <set field="portalPageId" from-field="parameters.portalPageId"/>
                                </actions>
                                <widgets>
                                    <include-screen name="commEvent"
                                            location="component://party/widget/partymgr/CommunicationScreens.xml" />
                                </widgets>
                            </section>
                        </container>
                        <container style="righthalf">
                            <label style="h1" text="${uiLabelMap.CommonRelatedInformation}" />
                            <section>
                                <actions>
                                    <set field="portalPageId" value="${parameters.portalPageId}"/>
                                </actions>
                                <widgets>
                                    <screenlet title="${uiLabelMap.PartyCommEventRoles}">
                                        <include-form name="ViewCommRoles"
                                            location="component://party/webapp/partymgr/communication/CommForms.xml" />
                                    </screenlet>
                                </widgets>
                            </section>
                            <section>
                                <actions>
                                    <set field="portalPageId" value="${parameters.portalPageId}"/>
                                </actions>
                                <widgets>
                                    <screenlet title="${uiLabelMap.PartyCommContent}">
                                        <include-form name="listCommContent"
                                            location="component://party/webapp/partymgr/communication/CommForms.xml" />
                                    </screenlet>
                                </widgets>
                            </section>
                            <section>
                                <actions>
                                    <entity-and list="commEvents" entity-name="CommunicationEvent">
                                        <field-map field-name="parentCommEventId"
                                            from-field="parameters.communicationEventId" />
                                    </entity-and>
                                </actions>
                                <widgets>
                                    <screenlet title="${uiLabelMap.PartyChildCommunicationEvents}">
                                        <include-form name="ListCommEvents"
                                            location="component://party/webapp/partymgr/communication/CommForms.xml" />
                                    </screenlet>
                                </widgets>
                            </section>
                            <section>
                                <actions>
                                    <set field="entityName" value="CustRequestAndCommEvent" />
                                    <set field="requestParameters.communicationEventId"
                                        from-field="parameters.communicationEventId" />
                                </actions>
                                <widgets>
                                    <screenlet title="${uiLabelMap.OrderRequestList}">
                                        <include-form name="ListRequests"
                                            location="component://order/webapp/ordermgr/request/RequestForms.xml" />
                                    </screenlet>
                                </widgets>
                            </section>
                        </container>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
    <screen name="ViewRequest">
        <section>
            <actions>
                <set field="MainColumnStyle" value="rightonly"/>
                <set field="tabButtonItem" value="ViewRequest"/>
                <set field="headerItem" value="request"/>
                <set field="titleProperty" value="PageTitleViewRequest"/>
                <set field="showRequestManagementLinks" value="Y"/>
                <set field="custRequestId" from-field="parameters.custRequestId"/>
                <entity-one entity-name="CustRequest" value-field="custRequest"/>
                <get-related-one value-field="custRequest" relation-name="CustRequestType" to-value-field="custRequestType"/>
                <get-related-one value-field="custRequest" relation-name="StatusItem" to-value-field="statusItem"/>
                <get-related-one value-field="custRequest" relation-name="CurrencyUom" to-value-field="currency"/>
                <get-related-one value-field="custRequest" relation-name="ProductStore" to-value-field="store"/>
                <get-related-one value-field="custRequest" relation-name="FulfillContactMech" to-value-field="fulfillContactMech"/>
                <entity-and list="requestWorkEfforts" entity-name="CustRequestAndWorkEffort">
                    <field-map field-name="custRequestId" from-field="parameters.custRequestId"/>
                </entity-and>
                <get-related value-field="custRequest" relation-name="CustRequestParty" list="requestParties"/>
                <set field="orderBy[]" value="sequenceNum"/>
                <get-related value-field="custRequest" relation-name="CustRequestItem" list="custRequestItems" order-by-list="orderBy"/>
                <entity-and list="commEvents" entity-name="CommunicationEventAndCustRequest">
                    <field-map field-name="custRequestId" from-field="parameters.custRequestId"/>
                </entity-and>
                <entity-and entity-name="CustRequestAndContent" list="custRequestAndContents">
                    <field-map field-name="custRequestId" from-field="custRequestId"/>
                </entity-and>                
            </actions>
            <widgets>
                <decorator-screen name="CommonRequestDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                        <container style="lefthalf">
                            <screenlet title="${uiLabelMap.OrderRequest} ${custRequest.custRequestId} ${uiLabelMap.CommonInformation}">
                                <include-form name="requestInfo" location="component://order/webapp/ordermgr/request/RequestForms.xml"/>
                            </screenlet>
                            <screenlet title="${uiLabelMap.PageTitleRequestItems}">
                                <include-form name="OverviewRequestItems" location="component://order/webapp/ordermgr/request/RequestForms.xml"/>
                            </screenlet>
                        </container>
                        <container style="righthalf">
                            <platform-specific>
                                <html><html-template location="component://order/webapp/ordermgr/request/requestDate.ftl"/></html>
                            </platform-specific>
                            <platform-specific>
                                <html><html-template location="component://order/webapp/ordermgr/request/requestContactMech.ftl"/></html>
                            </platform-specific>
                            <platform-specific>
                                <html><html-template location="component://order/webapp/ordermgr/request/requestRoles.ftl"/></html>
                            </platform-specific>
                            <screenlet title="${uiLabelMap.PartyListCommunicationEvents}" navigation-form-name="ViewRequestCommunicationEvents">
                                <include-form name="ViewRequestCommunicationEvents" location="component://order/webapp/ordermgr/request/RequestForms.xml"/>
                            </screenlet>
                            <screenlet title="${uiLabelMap.WorkEffortWorkEfforts}" navigation-form-name="ViewRequestWorkEfforts">
                                <include-form name="ViewRequestWorkEfforts" location="component://myportal/widget/MyPortalForms.xml"/>
                            </screenlet>
                            <screenlet title="${uiLabelMap.CommonContent}" navigation-form-name="ListCustRequestContent">
                                <include-form name="ListCustRequestContent" location="component://order/webapp/ordermgr/request/RequestForms.xml"/>
                            </screenlet>
                        </container>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
    <screen name="EditRequest">
        <section>
            <actions>
                <set field="titleProperty" value="OrderRequest"/>
                <set field="tabButtonItem" value="editRequest"/>
                <set field="headerItem" value="request"/>
                
                <set field="custRequestId" from-field="parameters.custRequestId"/>
                <entity-one entity-name="CustRequest" value-field="custRequest"/>
                
                <set field="statusId" from-field="custRequest.statusId"/>
                <entity-one entity-name="StatusItem" value-field="currentStatus"/>
            </actions>
            <widgets>
                <section>
                    <widgets>
                        <decorator-screen name="main-decorator"
                            location="${parameters.mainDecoratorLocation}">
                            <decorator-section name="body">
                                <screenlet title="${uiLabelMap.OrderNewRequest}">
                                    <include-form name="EditCustRequest" location="component://myportal/widget/MyPortalForms.xml"/>
                                </screenlet>
                            </decorator-section>
                        </decorator-screen>
                    </widgets>
                </section>
            </widgets>
        </section>
    </screen>
    <screen name="ListInvoices">
        <section>
            <actions>
                <set field="headerItem" value="invoices"/>
                <script location="component://party/webapp/partymgr/WEB-INF/actions/party/GetMyCompany.groovy"/>                
                <entity-condition list="invoices" entity-name="Invoice">
                    <condition-list combine="and">
                        <condition-expr field-name="partyId" operator="equals" from-field="myCompanyId"/>
                        <condition-list combine="or">
                            <condition-expr field-name="statusId" operator="equals" value="INVOICE_APPROVED"/>
                            <condition-expr field-name="statusId" operator="equals" value="INVOICE_SEND"/>
                            <condition-expr field-name="statusId" operator="equals" value="INVOICE_READY"/>
                            <condition-expr field-name="statusId" operator="equals" value="INVOICE_PAID"/>
                        </condition-list>
                    </condition-list>
                    <order-by field-name="invoiceDate DESC"/>
                </entity-condition>
            </actions>
            <widgets>
                    <screenlet title="${uiLabelMap.PageTitleListInvoices}" navigation-form-name="ListInvoices">
                        <include-form name="ListInvoices"  location="component://myportal/widget/MyPortalForms.xml"/>
                    </screenlet>
           </widgets>
        </section>
    </screen>
    <screen name="CreateCustRequestNotification">
        <section>
            <actions>
                <set field="title" value="${uiLabelMap.MyPageCustRequestNotificationMailCreation} #${custRequestId}"/>
            </actions>
            <widgets>
                <platform-specific><html><html-template location="component://myportal/templates/email/CreateCustRequestNotification.ftl"/></html></platform-specific>
            </widgets>
        </section>
    </screen>
    <screen name="CompletedCustRequestNotification">
        <section>
            <actions>
                <set field="title" value="${uiLabelMap.MyPageCustRequestNotificationMailCompleted} #${custRequestId}"/>
            </actions>
            <widgets>
                <platform-specific><html><html-template location="component://myportal/templates/email/CompletedCustRequestNotification.ftl"/></html></platform-specific>
            </widgets>
        </section>
    </screen>
    <screen name="EditCommunicationEvent">
        <section>
            <actions>
                <set field="titleProperty" value="PageTitleEditCommunication" />
                <set field="tabButtonItem" value="CommunicationEvent" />
                <set field="portalPageId" from-field="parameters.portalPageId" default-value="parameters.portalPageId"/>
                <set field="headerItem" from-field="parameters.portalPageId"/>
                <entity-one entity-name="CommunicationEvent" value-field="communicationEvent" />
                <script location="component://party/webapp/partymgr/WEB-INF/actions/communication/PrepCommEventReply.groovy"/>
                <script location="component://party/webapp/partymgr/WEB-INF/actions/communication/PrepCommEventForward.groovy"/>
            </actions>
            <widgets>
                <decorator-screen name="CommonCommunicationEventDecorator"
                    location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                        <section><!-- Email -->
                            <condition>
                                <or><!-- have for e-mails a special form -->
                                    <if-compare field="parameters.communicationEventTypeId"
                                        operator="equals" value="EMAIL_COMMUNICATION" />
                                    <if-compare field="parameters.communicationEventTypeId"
                                        operator="equals" value="AUTO_EMAIL_COMM" />
                                </or>
                            </condition>
                            <widgets>
                                <screenlet id="EditCommunicationEventPanel" title="${uiLabelMap.PartyEditCommunicationEvent}" collapsible="true">
                                    <include-form location="component://myportal/widget/MyPortalForms.xml" name="MyPortalNewEmail"/>
                                    <include-screen name="AttachFiletList"/>
                                </screenlet>
                            </widgets>
                        </section>
                        <section>
                            <condition><!-- internal note -->
                                <if-compare field="parameters.communicationEventTypeId"
                                    operator="equals" value="COMMENT_NOTE" />
                            </condition>
                            <widgets>
                                <screenlet id="EditCommunicationEventPanel" title="${uiLabelMap.PartyEditCommunicationEvent}" collapsible="true">
                                    <include-form location="component://party/webapp/partymgr/communication/CommForms.xml" name="NewInternalNote"/>
                                </screenlet>
                            </widgets>
                        </section>
                        <section>
                            <condition><!-- others -->
                                <and>
                                    <if-compare field="parameters.communicationEventTypeId"
                                        operator="not-equals" value="COMMENT_NOTE" />
                                    <if-compare field="parameters.communicationEventTypeId"
                                        operator="not-equals" value="EMAIL_COMMUNICATION" />
                                    <if-compare field="parameters.communicationEventTypeId"
                                        operator="not-equals" value="AUTO_EMAIL_COMM" />
                                </and>
                            </condition>
                            <widgets>
                                <screenlet id="EditCommunicationEventPanel"
                                    title="${uiLabelMap.PartyEditCommunicationEvent}" collapsible="true">
                                    <include-form
                                        location="component://party/webapp/partymgr/communication/CommForms.xml"
                                        name="EditCommEvent" />
                                </screenlet>
                                <screenlet title="${uiLabelMap.PartyChildCommunicationEvents}"
                                    navigation-form-name="ListChildCommEvents">
                                    <include-form
                                        location="component://party/webapp/partymgr/communication/CommForms.xml"
                                        name="ListChildCommEvents" />
                                </screenlet>
                            </widgets>
                        </section>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
    <screen name="addAttachmentEmail">
        <section>
            <actions>
                <entity-condition entity-name="MimeType" list="mimeTypes">
                    <order-by field-name="description"/>
                    <order-by field-name="mimeTypeId"/>
                </entity-condition>
                <set field="communicationEventId" from-field="parameters.communicationEventId"/>
                <set field="communicationEventTypeId" from-field="parameters.communicationEventTypeId"/>
                <set field="partyId" from-field="userLogin.partyId"/>                    
            </actions> 
            <widgets>
                <decorator-screen name="CommonCommunicationEventDecorator"
                    location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                        <platform-specific>
                            <html>
                                <html-template location="component://myportal/webapp/myportal/addAttachFile.ftl"/>
                            </html>
                        </platform-specific>
                    </decorator-section>
                </decorator-screen>
            </widgets>                   
        </section>
    </screen>    
    <screen name="AttachFiletList">
        <section>
            <actions>
                <property-map resource="CommonUiLabels" map-name="uiLabelMap" global="true"/>
                <property-map resource="ContentUiLabels" map-name="uiLabelMap" global="true"/>
                <entity-and entity-name="CommEventContentAssoc" list="commEventContent">
                    <field-map field-name="communicationEventId" from-field="parameters.communicationEventId"/>
                </entity-and>
                <entity-and entity-name="PartyContent" list="partyContent">
                    <field-map field-name="partyId" from-field="userLogin.partyId"/>
                </entity-and>
            </actions>
            <widgets>
                <platform-specific>
                    <html>
                        <html-template location="component://myportal/webapp/myportal/attachFileList.ftl"/>
                    </html>
                </platform-specific>
            </widgets>
        </section>
    </screen>
    <screen name="ListProjects">
        <section>
            <actions>
                <set field="headerItem" value="projects"/>
                <set field="layoutSettings.javaScripts[]" value="/images/jsgantt.js" global="true"/>
                <set field="layoutSettings.styleSheets[]" value="/images/jsgantt.css" global="true"/>
                <entity-condition list="projects" entity-name="WorkEffortPartyAssignment" filter-by-date="true">
                    <condition-list combine="and">
                        <condition-expr field-name="partyId" from-field="userLogin.partyId"/>
                        <condition-list combine="or">
                            <condition-expr field-name="roleTypeId" value="CLIENT_MANAGER"/>
                            <condition-expr field-name="roleTypeId" value="CLIENT_ANALYST"/>
                            <condition-expr field-name="roleTypeId" value="CLIENT_BILLING"/>
                        </condition-list>
                    </condition-list>
                </entity-condition>
            </actions>
            <widgets>
                        <iterate-section entry="project" list="projects">
                            <section>
                                <actions>
                                    <set field="projectId" from-field="project.workEffortId"/>
                                    <set field="parameters.projectId" from-field="project.workEffortId"/>
                                    <script location="component://projectmgr/webapp/projectmgr/WEB-INF/actions/GanttChart.groovy"/>
                                    <service service-name="getProject" result-map="result">
                                        <field-map field-name="projectId" from-field="projectId"/>
                                    </service>
                                    <set field="project" from-field="result.projectInfo"/>
                                </actions>
                                <widgets>
                                    <label style="h1" text="${uiLabelMap.ProjectMgrProjectCurrent}: ${project.projectName}[${project.projectId}]"/>
                                    <container style="lefthalf">
                                        <screenlet title="${uiLabelMap.PageTitleProjectInformation}">
                                            <include-form name="ProjectInfo" location="component://projectmgr/widget/forms/ProjectForms.xml"/>
                                        </screenlet>
                                        <section>
                                            <actions>
                                                <service service-name="getProjectPhaseList" result-map="result">
                                                    <field-map field-name="projectId" from-field="projectId"/>
                                                </service>
                                                <set field="phases" from-field="result.phaseList"/>
                                            </actions>
                                            <widgets>                
                                                <container style="screenlet">
                                                    <screenlet title="${uiLabelMap.ProjectMgrPhases}">
                                                        <include-form name="ListPhaseInfo" location="component://myportal/widget/MyPortalForms.xml"/>
                                                    </screenlet>
                                                </container>               
                                            </widgets>
                                        </section>
                                    </container>
                                    <container style="righthalf">
                                        <section>
                                            <actions>
                                                <service service-name="getProjectTaskList" result-map="result">
                                                    <field-map field-name="projectId" from-field="projectId"/>
                                                </service>
                                                <set field="tasks" from-field="result.taskList"/>
                                            </actions>
                                            <widgets>
                                                <screenlet title="${uiLabelMap.ProjectMgrTasks}" navigation-form-name="ListTaskInfo">
                                                    <include-form name="ListTaskInfo" location="component://myportal/widget/MyPortalForms.xml"/>
                                                </screenlet>                
                                            </widgets>
                                        </section>
                                    </container>
                                    <container style="clear"/>
                                    <screenlet title="${uiLabelMap.PageTitleProjectGanttChart}">
                                        <platform-specific>
                                            <html><html-template location="component://projectmgr/webapp/projectmgr/project/gantChart.ftl"/></html>
                                        </platform-specific>
                                    </screenlet>
                                </widgets>
                            </section>
                        </iterate-section>
                        <section>
                            <condition>
                                <if-empty field="projects"/>
                            </condition>
                            <widgets>
                                <label style="h2" text="${uiLabelMap.MyPageNoProjectsFound}"></label>
                            </widgets>
                        </section>
            </widgets>
        </section>
    </screen>
    <screen name="EditCustRequestContent">
        <section>
            <actions>
                <set field="titleProperty" value="PageTitleEditRequestContent"/>
                <set field="tabButtonItem" value="custRequestContent"/>
                <set field="headerItem" value="request"/>
                <set field="custRequestId" from-field="parameters.custRequestId"/>
                <entity-one entity-name="Content" value-field="content"/>
                <entity-one entity-name="CustRequest" value-field="custRequest"/>
                <entity-and entity-name="CustRequestContent" list="custRequestContents" filter-by-date="true">
                    <field-map field-name="custRequestId" from-field="custRequestId"/>
                </entity-and>
                <entity-and entity-name="CustRequestAndContent" list="custRequestAndContents">
                    <field-map field-name="custRequestId" from-field="custRequestId"/>
                </entity-and>
            </actions>
            <widgets>
                <decorator-screen name="CommonRequestDecorator" location="${parameters.mainDecoratorLocation}">
                    <decorator-section name="body">
                        <screenlet id="AddCustRequestContentsPanel" title="${uiLabelMap.PageTitleAddContent}" collapsible="true">
                            <include-form name="AddCustRequestContent" location="component://myportal/widget/RequestForms.xml"/>
                        </screenlet>
                        <include-form name="ListCustRequestContent" location="component://order/webapp/ordermgr/request/RequestForms.xml"/>
                    </decorator-section>
                </decorator-screen>
            </widgets>
        </section>
    </screen>
    
    <screen name="ListRequestList">
        <section>
            <actions>
                <service service-name="getUserPreferenceGroup" result-map="preferences">
                    <field-map field-name="userPrefGroupTypeId" value="MyPortal"/>
                </service>
                <!--  check if there are any customer requests for this user -->
                <entity-condition list="custRequests" entity-name="CustReqAndTypeAndPartyRel">
                    <condition-list combine="and">
                        <condition-expr field-name="statusId" operator="equals" value="CRQ_SUBMITTED"/>
                        <condition-list combine="and">
                            <condition-expr field-name="roleTypeIdTo" operator="equals" value="REQ_TAKER"/>
                            <condition-expr field-name="partyIdTo" operator="equals" from-field="userLogin.partyId"/>
                        </condition-list>
                    </condition-list>
                    <order-by field-name="-custRequestDate"/>
                </entity-condition>
            </actions>
            <widgets>
                <section>
                    <condition>
                        <not><if-empty field="custRequests"/></not>
                    </condition>
                    <widgets>
                        <screenlet title="${uiLabelMap.MyPortalIncomingCustRequests}" navigation-form-name="ListRequestList">
                            <include-form name="ListRequestList" location="component://order/webapp/ordermgr/request/RequestForms.xml"/>
                        </screenlet>
                    </widgets>
                </section>
            </widgets>
        </section>
    </screen>
    
    <screen name="ListCustRequests">        
        <section>
            <actions>
                <set field="partyId" from-field="userLogin.partyId"/>
                <set field="portalPageId" from-field="parameters.portalPageId"/>
                <set field="status" from-field="parameters.status" default-value="open"/>
                <set field="status" value="${bsh:&quot;all&quot;.equals(status)?&quot;%&quot;:&quot;open&quot;}"/>
                <entity-condition list="custRequests" entity-name="CustRequestInfoAndWorkEffortAndPartyRel">
                    <condition-list combine="and">
                        <condition-expr field-name="fromPartyId" operator="equals" value="${userLogin.partyId}"/>
                        <condition-list combine="or">
                            <condition-expr field-name="statusId" operator="equals" value="CRQ_REVIEWED"/>
                            <condition-expr field-name="statusId" operator="equals" value="CRQ_ACCEPTED"/>
                        </condition-list>
                    </condition-list>
                    <order-by field-name="+priority"/>
                    <order-by field-name="+custRequestDate"/>
                </entity-condition>
                <entity-condition list="custRequestsCompleted" entity-name="CustRequestInfoAndWorkEffortAndPartyRel">
                    <condition-list combine="and">
                        <condition-expr field-name="fromPartyId" operator="equals" value="${userLogin.partyId}"/>
                        <condition-list combine="or">
                            <condition-expr field-name="statusId" operator="equals" value="CRQ_COMPLETED"/>
                            <condition-expr field-name="statusId" operator="equals" value="CRQ_CANCELLED"/>
                        </condition-list>
                    </condition-list>
                    <order-by field-name="custRequestDate"/>
                </entity-condition>
                <script location="component://party/webapp/partymgr/WEB-INF/actions/party/GetMyCompany.groovy"/>                
                <entity-condition list="companyCustRequests" entity-name="CustRequestInfoAndWorkEffortAndPartyRel">
                    <condition-list combine="and">
                        <condition-expr field-name="partyIdFrom" operator="equals" value="${myCompanyId}"/>
                        <condition-expr field-name="fromPartyId" operator="not-equals" value="${userLogin.partyId}"/>
                    </condition-list>
                    <order-by field-name="custRequestDate"/>
                </entity-condition>
                <!-- only list internal notes to the customer do not show the incoming or outgoing emails: will confuse only -->
                <entity-condition entity-name="CommunicationEventAndRole" list="commEvents">
                    <condition-list combine="and">
                        <condition-expr field-name="communicationEventTypeId" operator="equals" value="COMMENT_NOTE" />
                        <condition-expr field-name="partyId" operator="equals" value="${partyId}" />
                        <condition-list combine="or">
                            <condition-expr field-name="roleStatusId"
                                operator="not-equals" value="COM_ROLE_COMPLETED" />
                            <condition-expr field-name="roleStatusId"
                                operator="like" value="${status}" />
                        </condition-list>
                    </condition-list>
                    <order-by field-name="-datetimeStarted" />
                </entity-condition>
            </actions>
            <widgets>
                <section>
                    <widgets>
                        <screenlet title="${uiLabelMap.MyPortalOpenCustomerRequests}" navigation-form-name="ListCustRequests" >
                            <link target="newrequest" text="${uiLabelMap.OrderNewRequest}" style="buttontext"/>
                            <include-form name="ListCustRequests" location="component://myportal/widget/MyPortalForms.xml"/>
                        </screenlet>
                    </widgets>
                </section>
            </widgets>
        </section>
    </screen>
    
    <screen name="ListCustRequestsCompleted">
        <section>
            <actions>
                <set field="partyId" from-field="userLogin.partyId"/>
                <set field="status" from-field="parameters.status" default-value="open"/>
                <set field="status" value="${bsh:&quot;all&quot;.equals(status)?&quot;%&quot;:&quot;open&quot;}"/>
                <entity-condition list="custRequests" entity-name="CustRequestInfoAndWorkEffortAndPartyRel">
                    <condition-list combine="and">
                        <condition-expr field-name="fromPartyId" operator="equals" value="${userLogin.partyId}"/>
                        <condition-list combine="or">
                            <condition-expr field-name="statusId" operator="equals" value="CRQ_REVIEWED"/>
                            <condition-expr field-name="statusId" operator="equals" value="CRQ_ACCEPTED"/>
                        </condition-list>
                    </condition-list>
                    <order-by field-name="+priority"/>
                    <order-by field-name="+custRequestDate"/>
                </entity-condition>
                <entity-condition list="custRequestsCompleted" entity-name="CustRequestInfoAndWorkEffortAndPartyRel">
                    <condition-list combine="and">
                        <condition-expr field-name="fromPartyId" operator="equals" value="${userLogin.partyId}"/>
                        <condition-list combine="or">
                            <condition-expr field-name="statusId" operator="equals" value="CRQ_COMPLETED"/>
                            <condition-expr field-name="statusId" operator="equals" value="CRQ_CANCELLED"/>
                        </condition-list>
                    </condition-list>
                    <order-by field-name="custRequestDate"/>
                </entity-condition>
                <script location="component://party/webapp/partymgr/WEB-INF/actions/party/GetMyCompany.groovy"/>                
                <entity-condition list="companyCustRequests" entity-name="CustRequestInfoAndWorkEffortAndPartyRel">
                    <condition-list combine="and">
                        <condition-expr field-name="partyIdFrom" operator="equals" value="${myCompanyId}"/>
                        <condition-expr field-name="fromPartyId" operator="not-equals" value="${userLogin.partyId}"/>
                    </condition-list>
                    <order-by field-name="custRequestDate"/>
                </entity-condition>
                <!-- only list internal notes to the customer do not show the incoming or outgoing emails: will confuse only -->
                <entity-condition entity-name="CommunicationEventAndRole" list="commEvents">
                    <condition-list combine="and">
                        <condition-expr field-name="communicationEventTypeId" operator="equals" value="COMMENT_NOTE" />
                        <condition-expr field-name="partyId" operator="equals" value="${partyId}" />
                        <condition-list combine="or">
                            <condition-expr field-name="roleStatusId"
                                operator="not-equals" value="COM_ROLE_COMPLETED" />
                            <condition-expr field-name="roleStatusId"
                                operator="like" value="${status}" />
                        </condition-list>
                    </condition-list>
                    <order-by field-name="-datetimeStarted" />
                </entity-condition>
            </actions>
            <widgets>
                <section>
                    <widgets>
                        <screenlet title="${uiLabelMap.MyPortalCompletedCustomerRequests}" navigation-form-name="ListCustRequestsCompleted">
                            <include-form name="ListCustRequestsCompleted" location="component://myportal/widget/MyPortalForms.xml"/>
                        </screenlet>
                    </widgets>
                </section>
            </widgets>
        </section>
    </screen>
    
    <screen name="ListPartyCommEvents">
        <section>
            <actions>
                <set field="partyId" from-field="userLogin.partyId"/>
                <set field="status" from-field="parameters.status" default-value="open"/>
                <set field="status" value="${bsh:&quot;all&quot;.equals(status)?&quot;%&quot;:&quot;open&quot;}"/>
                <entity-condition list="custRequests" entity-name="CustRequestInfoAndWorkEffortAndPartyRel">
                    <condition-list combine="and">
                        <condition-expr field-name="fromPartyId" operator="equals" value="${userLogin.partyId}"/>
                        <condition-list combine="or">
                            <condition-expr field-name="statusId" operator="equals" value="CRQ_REVIEWED"/>
                            <condition-expr field-name="statusId" operator="equals" value="CRQ_ACCEPTED"/>
                        </condition-list>
                    </condition-list>
                    <order-by field-name="+priority"/>
                    <order-by field-name="+custRequestDate"/>
                </entity-condition>
                <entity-condition list="custRequestsCompleted" entity-name="CustRequestInfoAndWorkEffortAndPartyRel">
                    <condition-list combine="and">
                        <condition-expr field-name="fromPartyId" operator="equals" value="${userLogin.partyId}"/>
                        <condition-list combine="or">
                            <condition-expr field-name="statusId" operator="equals" value="CRQ_COMPLETED"/>
                            <condition-expr field-name="statusId" operator="equals" value="CRQ_CANCELLED"/>
                        </condition-list>
                    </condition-list>
                    <order-by field-name="custRequestDate"/>
                </entity-condition>
                <script location="component://party/webapp/partymgr/WEB-INF/actions/party/GetMyCompany.groovy"/>                
                <entity-condition list="companyCustRequests" entity-name="CustRequestInfoAndWorkEffortAndPartyRel">
                    <condition-list combine="and">
                        <condition-expr field-name="partyIdFrom" operator="equals" value="${myCompanyId}"/>
                        <condition-expr field-name="fromPartyId" operator="not-equals" value="${userLogin.partyId}"/>
                    </condition-list>
                    <order-by field-name="custRequestDate"/>
                </entity-condition>
                <!-- only list internal notes to the customer do not show the incoming or outgoing emails: will confuse only -->
                <entity-condition entity-name="CommunicationEventAndRole" list="commEvents">
                    <condition-list combine="and">
                        <condition-expr field-name="communicationEventTypeId" operator="equals" value="COMMENT_NOTE" />
                        <condition-expr field-name="partyId" operator="equals" value="${partyId}" />
                        <condition-list combine="or">
                            <condition-expr field-name="roleStatusId"
                                operator="not-equals" value="COM_ROLE_COMPLETED" />
                            <condition-expr field-name="roleStatusId"
                                operator="like" value="${status}" />
                        </condition-list>
                    </condition-list>
                    <order-by field-name="-datetimeStarted" />
                </entity-condition>
            </actions>
            <widgets>
                <section>
                     <widgets>
                        <screenlet title="${uiLabelMap.MyPortalOtherCompanyCustomerRequests}" navigation-form-name="ListOtherCompanyRequests">
                            <include-form name="ListOtherCompanyRequests" location="component://myportal/widget/MyPortalForms.xml"/>
                        </screenlet>
                    </widgets>
                </section>
                <section>
                    <widgets>
                        <screenlet title="${uiLabelMap.MyPortalCommunicationsOfParty}: ${partyName.firstName} ${partyName.middleName} ${partyName.lastName} ${partyName.groupName} [${partyId}] "
                            navigation-menu-name="communicationsMenu" navigation-form-name="ListPartyCommEvents" name="myComms">
                            <include-menu name="communicationsMenu" location="component://myportal/widget/MyPortalMenus.xml" />
                            <include-form name="ListPartyCommEvents" location="component://myportal/widget/MyPortalForms.xml" />
                        </screenlet>    
                    </widgets>
                </section>
            </widgets>
        </section>
    </screen>
    
    <screen name="ContentList">
        <section>
            <actions>
                <property-map resource="CommonUiLabels" map-name="uiLabelMap" global="true"/>
                <property-map resource="ContentUiLabels" map-name="uiLabelMap" global="true"/>
                <entity-and entity-name="PartyContent" list="partyContent">
                    <field-map field-name="partyId" from-field="parameters.partyId"/>
                </entity-and>
            </actions>
            <widgets>
                <platform-specific>
                    <html>
                        <html-template location="component://party/webapp/partymgr/party/profileblocks/ContentList.ftl"/>
                    </html>
                </platform-specific>
            </widgets>
        </section>
    </screen>

    <!-- My Profile Screens -->    
    <screen name="Party">
        <section>
            <actions>
                <set field="parameters.partyId" from-field="userLogin.partyId"/> 
                <script location="component://party/webapp/partymgr/WEB-INF/actions/party/ViewProfile.groovy"/>
                <script location="component://party/webapp/partymgr/WEB-INF/actions/party/GetUserLoginPrimaryEmail.groovy"/>
            </actions>
            <widgets>
                <section>
                    <condition>
                        <not><if-empty field="party"/></not>
                    </condition>
                    <widgets>
                        <section>
                            <widgets>
                                <include-screen name="Party" location="component://party/widget/partymgr/ProfileScreens.xml"/>
                            </widgets>
                        </section>
                    </widgets>
                    <fail-widgets>
                        <container>
                            <label style="h3">${uiLabelMap.PartyNoPartyFoundWithPartyId}: ${parameters.partyId}</label>
                        </container>
                    </fail-widgets>
                </section>
            </widgets>
        </section>
    </screen>

    <screen name="Contact">
        <section>
            <actions>
                <set field="parameters.partyId" from-field="userLogin.partyId"/> 
                <script location="component://party/webapp/partymgr/WEB-INF/actions/party/ViewProfile.groovy"/>
                <script location="component://party/webapp/partymgr/WEB-INF/actions/party/GetUserLoginPrimaryEmail.groovy"/>
            </actions>
            <widgets>
                <section>
                    <condition>
                        <not><if-empty field="party"/></not>
                    </condition>
                    <widgets>
                        <section>
                            <widgets>
                                <include-screen name="Contact" location="component://party/widget/partymgr/ProfileScreens.xml"/>
                            </widgets>
                        </section>
                    </widgets>
                    <fail-widgets>
                        <container>
                            <label style="h3">${uiLabelMap.PartyNoPartyFoundWithPartyId}: ${parameters.partyId}</label>
                        </container>
                    </fail-widgets>
                </section>
            </widgets>
        </section>
    </screen>

    <screen name="contactsAndAccounts">
        <section>
            <actions>
                <set field="parameters.partyId" from-field="userLogin.partyId"/> 
                <script location="component://party/webapp/partymgr/WEB-INF/actions/party/ViewProfile.groovy"/>
                <script location="component://party/webapp/partymgr/WEB-INF/actions/party/GetUserLoginPrimaryEmail.groovy"/>
            </actions>
            <widgets>
                <section>
                    <condition>
                        <not><if-empty field="party"/></not>
                    </condition>
                    <widgets>
                        <section>
                            <widgets>
                                <include-screen name="contactsAndAccounts" location="component://party/widget/partymgr/ProfileScreens.xml"/>
                            </widgets>
                        </section>
                    </widgets>
                    <fail-widgets>
                        <container>
                            <label style="h3">${uiLabelMap.PartyNoPartyFoundWithPartyId}: ${parameters.partyId}</label>
                        </container>
                    </fail-widgets>
                </section>
            </widgets>
        </section>
    </screen>

    <screen name="LoyaltyPoints">
        <section>
            <actions>
                <set field="parameters.partyId" from-field="userLogin.partyId"/> 
                <script location="component://party/webapp/partymgr/WEB-INF/actions/party/ViewProfile.groovy"/>
                <script location="component://party/webapp/partymgr/WEB-INF/actions/party/GetUserLoginPrimaryEmail.groovy"/>
            </actions>
            <widgets>
                <section>
                    <condition>
                        <not><if-empty field="party"/></not>
                    </condition>
                    <widgets>
                        <section>
                            <widgets>
                                <include-screen name="LoyaltyPoints" location="component://party/widget/partymgr/ProfileScreens.xml"/>
                            </widgets>
                        </section>
                    </widgets>
                    <fail-widgets>
                        <container>
                            <label style="h3">${uiLabelMap.PartyNoPartyFoundWithPartyId}: ${parameters.partyId}</label>
                        </container>
                    </fail-widgets>
                </section>
            </widgets>
        </section>
    </screen>

    <screen name="PaymentMethods">
        <section>
            <actions>
                <set field="parameters.partyId" from-field="userLogin.partyId"/> 
                <script location="component://party/webapp/partymgr/WEB-INF/actions/party/ViewProfile.groovy"/>
                <script location="component://party/webapp/partymgr/WEB-INF/actions/party/GetUserLoginPrimaryEmail.groovy"/>
            </actions>
            <widgets>
                <section>
                    <condition>
                        <not><if-empty field="party"/></not>
                    </condition>
                    <widgets>
                        <section>
                            <widgets>
                                <include-screen name="PaymentMethods" location="component://party/widget/partymgr/ProfileScreens.xml"/>
                            </widgets>
                        </section>
                    </widgets>
                    <fail-widgets>
                        <container>
                            <label style="h3">${uiLabelMap.PartyNoPartyFoundWithPartyId}: ${parameters.partyId}</label>
                        </container>
                    </fail-widgets>
                </section>
            </widgets>
        </section>
    </screen>

    <screen name="AvsSettings">
        <section>
            <actions>
                <set field="parameters.partyId" from-field="userLogin.partyId"/> 
                <script location="component://party/webapp/partymgr/WEB-INF/actions/party/ViewProfile.groovy"/>
                <script location="component://party/webapp/partymgr/WEB-INF/actions/party/GetUserLoginPrimaryEmail.groovy"/>
            </actions>
            <widgets>
                <section>
                    <condition>
                        <not><if-empty field="party"/></not>
                    </condition>
                    <widgets>
                        <section>
                            <widgets>
                                <include-screen name="AvsSettings" location="component://party/widget/partymgr/ProfileScreens.xml"/>
                            </widgets>
                        </section>
                    </widgets>
                    <fail-widgets>
                        <container>
                            <label style="h3">${uiLabelMap.PartyNoPartyFoundWithPartyId}: ${parameters.partyId}</label>
                        </container>
                    </fail-widgets>
                </section>
            </widgets>
        </section>
    </screen>

    <screen name="FinAccounts">
        <section>
            <actions>
                <set field="parameters.partyId" from-field="userLogin.partyId"/> 
                <script location="component://party/webapp/partymgr/WEB-INF/actions/party/ViewProfile.groovy"/>
                <script location="component://party/webapp/partymgr/WEB-INF/actions/party/GetUserLoginPrimaryEmail.groovy"/>
            </actions>
            <widgets>
                <section>
                    <condition>
                        <not><if-empty field="party"/></not>
                    </condition>
                    <widgets>
                        <section>
                            <widgets>
                                <include-screen name="FinAccounts" location="component://party/widget/partymgr/ProfileScreens.xml"/>
                            </widgets>
                        </section>
                    </widgets>
                    <fail-widgets>
                        <container>
                            <label style="h3">${uiLabelMap.PartyNoPartyFoundWithPartyId}: ${parameters.partyId}</label>
                        </container>
                    </fail-widgets>
                </section>
            </widgets>
        </section>
    </screen>

    <screen name="UserLogin">
        <section>
            <actions>
                <set field="parameters.partyId" from-field="userLogin.partyId"/> 
                <script location="component://party/webapp/partymgr/WEB-INF/actions/party/ViewProfile.groovy"/>
                <script location="component://party/webapp/partymgr/WEB-INF/actions/party/GetUserLoginPrimaryEmail.groovy"/>
            </actions>
            <widgets>
                <section>
                    <condition>
                        <not><if-empty field="party"/></not>
                    </condition>
                    <widgets>
                        <section>
                            <widgets>
                                <include-screen name="UserLogin" location="component://party/widget/partymgr/ProfileScreens.xml"/>
                            </widgets>
                        </section>
                    </widgets>
                    <fail-widgets>
                        <container>
                            <label style="h3">${uiLabelMap.PartyNoPartyFoundWithPartyId}: ${parameters.partyId}</label>
                        </container>
                    </fail-widgets>
                </section>
            </widgets>
        </section>
    </screen>

    <screen name="Attributes">
        <section>
            <actions>
                <set field="parameters.partyId" from-field="userLogin.partyId"/> 
                <script location="component://party/webapp/partymgr/WEB-INF/actions/party/ViewProfile.groovy"/>
                <script location="component://party/webapp/partymgr/WEB-INF/actions/party/GetUserLoginPrimaryEmail.groovy"/>
            </actions>
            <widgets>
                <section>
                    <condition>
                        <not><if-empty field="party"/></not>
                    </condition>
                    <widgets>
                        <section>
                            <widgets>
                                <include-screen name="Attributes" location="component://party/widget/partymgr/ProfileScreens.xml"/>
                            </widgets>
                        </section>
                    </widgets>
                    <fail-widgets>
                        <container>
                            <label style="h3">${uiLabelMap.PartyNoPartyFoundWithPartyId}: ${parameters.partyId}</label>
                        </container>
                    </fail-widgets>
                </section>
            </widgets>
        </section>
    </screen>

    <screen name="Visits">
        <section>
            <actions>
                <set field="parameters.partyId" from-field="userLogin.partyId"/> 
                <script location="component://party/webapp/partymgr/WEB-INF/actions/party/ViewProfile.groovy"/>
                <script location="component://party/webapp/partymgr/WEB-INF/actions/party/GetUserLoginPrimaryEmail.groovy"/>
            </actions>
            <widgets>
               <section>
                  <condition>
                      <not><if-empty field="party"/></not>
                  </condition>
                  <widgets>
                      <section>
                         <widgets>
                             <include-screen name="Visits" location="component://party/widget/partymgr/ProfileScreens.xml"/>
                         </widgets>
                      </section>
                      </widgets>
                         <fail-widgets>
                             <container>
                                 <label style="h3">${uiLabelMap.PartyNoPartyFoundWithPartyId}: ${parameters.partyId}</label>
                             </container>
                         </fail-widgets>
               </section>
            </widgets>
        </section>
    </screen>

    <screen name="Cart">
        <section>
            <actions>
                <set field="parameters.partyId" from-field="userLogin.partyId"/> 
                <script location="component://party/webapp/partymgr/WEB-INF/actions/party/ViewProfile.groovy"/>
                <script location="component://party/webapp/partymgr/WEB-INF/actions/party/GetUserLoginPrimaryEmail.groovy"/>
            </actions>
            <widgets>
                <section>
                    <condition>
                        <not><if-empty field="party"/></not>
                    </condition>
                    <widgets>
                        <section>
                            <widgets>
                                <include-screen name="Cart" location="component://party/widget/partymgr/ProfileScreens.xml"/>
                            </widgets>
                        </section>
                    </widgets>
                    <fail-widgets>
                        <container>
                            <label style="h3">${uiLabelMap.PartyNoPartyFoundWithPartyId}: ${parameters.partyId}</label>
                        </container>
                    </fail-widgets>
                </section>
            </widgets>
        </section>
    </screen>

    <screen name="SerializedInventory">
        <section>
            <actions>
                <set field="parameters.partyId" from-field="userLogin.partyId"/> 
                <script location="component://party/webapp/partymgr/WEB-INF/actions/party/ViewProfile.groovy"/>
                <script location="component://party/webapp/partymgr/WEB-INF/actions/party/GetUserLoginPrimaryEmail.groovy"/>
            </actions>
            <widgets>
                <section>
                    <condition>
                        <not><if-empty field="party"/></not>
                    </condition>
                    <widgets>
                        <section>
                            <widgets>
                                <include-screen name="SerializedInventory" location="component://party/widget/partymgr/ProfileScreens.xml"/>
                            </widgets>
                        </section>
                    </widgets>
                    <fail-widgets>
                        <container>
                            <label style="h3">${uiLabelMap.PartyNoPartyFoundWithPartyId}: ${parameters.partyId}</label>
                        </container>
                    </fail-widgets>
                </section>
            </widgets>
        </section>
    </screen>

    <screen name="Subscriptions">
        <section>
            <actions>
                <set field="parameters.partyId" from-field="userLogin.partyId"/> 
                <script location="component://party/webapp/partymgr/WEB-INF/actions/party/ViewProfile.groovy"/>
                <script location="component://party/webapp/partymgr/WEB-INF/actions/party/GetUserLoginPrimaryEmail.groovy"/>
            </actions>
            <widgets>
                <section>
                    <condition>
                        <not><if-empty field="party"/></not>
                    </condition>
                    <widgets>
                        <section>
                            <widgets>
                                <include-screen name="Subscriptions" location="component://party/widget/partymgr/ProfileScreens.xml"/>
                            </widgets>
                        </section>
                    </widgets>
                    <fail-widgets>
                        <container>
                            <label style="h3">${uiLabelMap.PartyNoPartyFoundWithPartyId}: ${parameters.partyId}</label>
                        </container>
                    </fail-widgets>
                </section>
            </widgets>
        </section>
    </screen>

    <screen name="Content">
        <section>
            <actions>
                <set field="parameters.partyId" from-field="userLogin.partyId"/> 
                <script location="component://party/webapp/partymgr/WEB-INF/actions/party/ViewProfile.groovy"/>
                <script location="component://party/webapp/partymgr/WEB-INF/actions/party/GetUserLoginPrimaryEmail.groovy"/>
            </actions>
            <widgets>
                <section>
                    <condition>
                        <not><if-empty field="party"/></not>
                    </condition>
                    <widgets>
                        <section>
                            <widgets>
                                <include-screen name="Content" location="component://party/widget/partymgr/ProfileScreens.xml"/>
                            </widgets>
                        </section>
                    </widgets>
                    <fail-widgets>
                        <container>
                            <label style="h3">${uiLabelMap.PartyNoPartyFoundWithPartyId}: ${parameters.partyId}</label>
                        </container>
                    </fail-widgets>
                </section>
            </widgets>
        </section>
    </screen>

    <screen name="ShipperAccount">
        <section>
            <actions>
                <set field="parameters.partyId" from-field="userLogin.partyId"/> 
                <script location="component://party/webapp/partymgr/WEB-INF/actions/party/ViewProfile.groovy"/>
                <script location="component://party/webapp/partymgr/WEB-INF/actions/party/GetUserLoginPrimaryEmail.groovy"/>
            </actions>
            <widgets>
                <section>
                    <condition>
                        <not><if-empty field="party"/></not>
                    </condition>
                    <widgets>
                        <section>
                            <widgets>
                                <include-screen name="ShipperAccount" location="component://party/widget/partymgr/ProfileScreens.xml"/>
                            </widgets>
                        </section>
                    </widgets>
                    <fail-widgets>
                        <container>
                            <label style="h3">${uiLabelMap.PartyNoPartyFoundWithPartyId}: ${parameters.partyId}</label>
                        </container>
                    </fail-widgets>
                </section>
            </widgets>
        </section>
    </screen>

    <screen name="Notes">
        <section>
            <actions>
                <set field="parameters.partyId" from-field="userLogin.partyId"/> 
                <script location="component://party/webapp/partymgr/WEB-INF/actions/party/ViewProfile.groovy"/>
                <script location="component://party/webapp/partymgr/WEB-INF/actions/party/GetUserLoginPrimaryEmail.groovy"/>
            </actions>
            <widgets>
                <section>
                    <condition>
                        <not><if-empty field="party"/></not>
                    </condition>
                    <widgets>
                        <section>
                            <widgets>
                                <include-screen name="Notes" location="component://party/widget/partymgr/ProfileScreens.xml"/>
                            </widgets>
                        </section>
                    </widgets>
                    <fail-widgets>
                        <container>
                            <label style="h3">${uiLabelMap.PartyNoPartyFoundWithPartyId}: ${parameters.partyId}</label>
                        </container>
                    </fail-widgets>
                </section>
            </widgets>
        </section>
    </screen>

    <screen name="mytasksParty">
        <section>
            <actions>
                <set field="parameters.partyId" from-field="userLogin.partyId"/> 
                <script location="component://party/webapp/partymgr/WEB-INF/actions/party/ViewProfile.groovy"/>
                <script location="component://party/webapp/partymgr/WEB-INF/actions/party/GetUserLoginPrimaryEmail.groovy"/>
            </actions>
            <widgets>
                <section>
                    <condition>
                        <not><if-empty field="party"/></not>
                    </condition>
                    <widgets>
                        <section>
                            <widgets>
                                <include-screen name="mytasks" location="component://party/widget/partymgr/ProfileScreens.xml"/>
                            </widgets>
                        </section>
                    </widgets>
                    <fail-widgets>
                        <container>
                            <label style="h3">${uiLabelMap.PartyNoPartyFoundWithPartyId}: ${parameters.partyId}</label>
                        </container>
                    </fail-widgets>
                </section>
            </widgets>
        </section>
    </screen>

    <screen name="ViewInternalOrg">
        <section>
            <actions>
                <set field="parameters.partyId" from-field="userLogin.partyId"/> 
                <script location="component://party/webapp/partymgr/WEB-INF/actions/party/ViewProfile.groovy"/>
                <script location="component://party/webapp/partymgr/WEB-INF/actions/party/GetUserLoginPrimaryEmail.groovy"/>
            </actions>
            <widgets>
                <section>
                    <condition>
                        <not><if-empty field="party"/></not>
                    </condition>
                    <widgets>
                        <section>
                            <widgets>
                                <include-screen name="ViewInternalOrg" location="component://party/widget/partymgr/ProfileScreens.xml"/>
                            </widgets>
                        </section>
                    </widgets>
                    <fail-widgets>
                        <container>
                            <label style="h3">${uiLabelMap.PartyNoPartyFoundWithPartyId}: ${parameters.partyId}</label>
                        </container>
                    </fail-widgets>
                </section>
            </widgets>
        </section>
    </screen>
    
    <screen name="CreateUserNotification">
        <section>
            <actions>
                <set field="title" value="${uiLabelMap.MyPageCustRequestNotificationMailCreation}"/>
            </actions>
            <widgets>
                <platform-specific><html><html-template location="component://party/templates/email/CreatePartyNotification.ftl"/></html></platform-specific>
            </widgets>
        </section>
    </screen>
    
</screens>
