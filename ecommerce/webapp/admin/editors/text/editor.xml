<?xml version="1.0"?>

#set ( $parentPage = $request.getParameter( "parentPage" ) )
#set ( $origURL = $request.getParameter( "origURL" ) )
#set ( $editPath = $request.getParameter( "editPath" ) )
#set ( $editableContent = $site.getEditableContentForPath( $editPath ) )

<page xmlns="http://www.einnovation.com/xmlns/WSP/Admin/Content"
    xmlns:html="http://www.w3.org/1999/xhtml" onload="window.focus();">
  <title>Edit Page</title>
  <content>
    <html:script type="text/javascript">
		window.focus();
		function saveAndClose()
		{
			document.wizard.action = "$origURL";
			document.wizard.target = "$parentPage";
			document.wizard.submit();
			window.close();
		}
		
		function Check4Tab(el)
		{
		  // Run only in IE
		  // and if tab key is pressed
		  // and if the control key is pressed
		  if ((document.all) &amp;&amp; (9==event.keyCode))
		  {
		      // Cache the selection
		      el.selection=document.selection.createRange();
		      el.selection.text=String.fromCharCode(9)
		      event.returnValue=false
		  }          
		}
    </html:script>
    <dialog fill="yes">
      <content>
	    <box>
          #foreach( $entry in $editableContent.requiredParameters.entrySet() )
              <html:input type="hidden" name="$entry.key" value="$entry.value" />
          #end
          <html:div align="center">
            <html:textarea name="$editableContent.contentParameter" onkeydown="Check4Tab(this)" id="escapedContent"
                cols="80" rows="30"><![CDATA[$editableContent.content]]></html:textarea>
          </html:div>
        </box>
      </content>
      <buttons>
      	<button onclick="saveAndClose()" name="Save"/>
      	<cancel onclick="window.close()"/>
      </buttons>
    </dialog>
  </content>
</page>
