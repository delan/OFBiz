<html><head>
<style type="text/css">
.imagebutton, .imageButtonClick {height: 20; width: 21; border: solid 1px #D4D0C8; background-color: #D4D0C8}
.imagebuttonHover {height: 20; width: 21; border: outset 1px; background-color: #EEEEEE}
/* .imagebutton img, .imagebuttonHover img {position: relative; left: 0; top: 0} */
.imagebuttonDown {height: 20; width: 21; border: inset 1px; background-color: #D4D0C8}
.imagebuttonDownHover {height: 20; width: 21; border: inset 1px; background-color: #EEEEEE}
/* .imagebuttonDown img, .imagebuttonDownHover img {position: relative; left: 1; top: 1} */
.image {position: relative; left: 0; top: 0; height:20; width:21; border:none;}
.toolbar {height: 30; background-color: #D4D0C8;}
</style>

<!-- Velocity commands
#set ( $parentPage = $request.getParameter( "parentPage" ) )
#set ( $editPath = $request.getParameter( "editPath" ) )
#set ( $origURL = $request.getParameter( "origURL" ) )
#set ( $editableContent = $site.getEditableContentForPath( $editPath ) )
-->

<script language="JavaScript" src="code.js"></script>
<script language="JavaScript" src="/fonts.js"></script> <!-- FIXME: Do this properly. -->
<script language="JavaScript">

function ImagePicked(newImage)
{
	//alert( newImage );
	getEditDocument().execCommand("InsertImage",false,newImage);
}
function saveAndClose()
{
	//what is this silly thing here for? ${editableContent.contentParameter}
	document.contentForm.content.value = getEditDocument().body.innerHTML;
	document.contentForm.submit();
	
	window.close();
	//There is a bug with Mozilla, when posting to a named frame it will not reload the content
	/*if ( window.opener )
	{
		
		window.opener.location.reload();

	}
	*/
}

function Start() {

    InitToolbarButtons();
	if ( !gecko )
	{
		//IE will give permission denied on getText() unless this is here
	   getEditDocument().designMode = "on";
	}
	
	addEvent(document,"mousedown", dismisscolorpalette, true);	
	addEvent(getEditDocument(),"mousedown", dismisscolorpalette, true);	
	addEvent(document,"keypress", dismisscolorpalette, true);
	addEvent( getEditDocument(),"keypress", dismisscolorpalette, true);
	
	getEditDocument().open();
	
	getEditDocument().write( "<html><head><base href='$url_util.buildStandard( $editPath )'>");
	if ( !gecko )
	{
	    //this breaks gecko
		getEditDocument().write("<link rel='stylesheet' type='text/css' href='/fonts.css'>");
	}
	getEditDocument().write("</head><body>");
	getEditDocument().write(  document.getElementById( 'source' ).value  );
	getEditDocument().write( "</body></html>" );
		getEditDocument().close();
	
	
	if ( gecko )
	{
		//Mozilla will not edit unless you do this last
		getEditDocument().designMode = "on";
	}
    getEditDocument().bgColor = "white";
	getEditWindow().focus();
    setTimeout("UpdateTimer()", 100);
    
    populateClassDropdown();
}
</script>

</head>

<body bgcolor="#D4D0C8" onload="Start()" leftmargin="0" topmargin="0" leftmargin="0"  marginwidth="0" marginheight="0" >

<table  id="toolbar1" border="0" cellpadding="4" cellspacing="0"  style="visibility: visible;">
<tbody><tr>
<td>
<div class="imagebuttonClick" id="save"><img class="image" src="newedit_files/saveas.gif" alt="Save" title="Save" style="left: 1px; top: 1px;"></div>

</td>

<td>
<!-- This works in Mozilla, not in IE, even though it's standard HTML 4.01.
<select id="classname" onchange="Select(this.id);">
	<option value="(none)">(none)</option>
	<optgroup label="Paragraph Styles">
		<option value="class-a">Class A</option>
		<option value="class-b">Class B</option>
	</optgroup>
	<optgroup label="Character Styles">
		<option value="class-c">Class C</option>
	</optgroup>
</select>
-->
<!-- And similarly, the disabled attribute works in Mozilla but not IE. -->
<select id="classname" onchange="Select(this.id);">
</select>
</td>
<td>
<select id="formatblock" onchange="Select(this.id);"><option value="Paragraph">Paragraph</option><option value="Normal">Normal</option><option value="Heading 1">Heading 1 </option><option value="Heading 2">Heading 2 </option><option value="Heading 3">Heading 3 </option><option value="Heading 4">Heading 4 </option><option value="Heading 5">Heading 5 </option><option value="Heading 6">Heading 6 </option><option value="Address">Address </option><option value="Formatted">Formatted </option></select>
</td>
<td>
<select id="fontname" onchange="Select(this.id);"><option value="Font">Font</option><option value="Arial">Arial</option><option value="Courier">Courier</option><option value="Times New Roman">Times New Roman</option></select>
</td>
<td>
<select unselectable="on" id="fontsize" onchange="Select(this.id);"><option value="Size">Size</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option></select>
</td>
<td>
<div class="imagebutton" id="bold"><img class="image" src="newedit_files/bold.gif" alt="Bold" title="Bold" style="left: 1px; top: 1px;"></div>
</td>
<td>
<div class="imagebutton" id="italic"><img class="image" src="newedit_files/italic.gif" alt="Italic" title="Italic"></div>
</td>
<td>
<div class="imagebutton" id="underline"><img class="image" src="newedit_files/underline.gif" alt="Underline" title="Underline"></div>
</td>
<td>
</td>
<td>
<div class="imagebutton" id="justifyleft"><img class="image" src="newedit_files/justifyleft.gif" alt="Align Left" title="Align Left"></div>
</td>
<td>
<div class="imagebutton" id="justifycenter"><img class="image" src="newedit_files/justifycenter.gif" alt="Center" title="Center"></div>
</td>
<td>
<div class="imagebutton" id="justifyright"><img class="image" src="newedit_files/justifyright.gif" alt="Align Right" title="Align Right"></div>
<td>

<div class="imagebuttonClick" id="forecolor"><img class="image" src="newedit_files/forecolor.gif" alt="Text Color" title="Text Color" style="left: 1px; top: 1px;"></div>
</td>
<td>
<div class="imagebuttonClick" id="backcolor"><img class="image" src="newedit_files/backcolor.gif" alt="Background Color" title="Background Color" style="left: 1px; top: 1px;"></div>
</td>
<td>
</td>
<td>
<div class="imagebutton" id="insertorderedlist"><img class="image" src="newedit_files/orderedlist.gif" alt="Ordered List" title="Ordered List"></div>
</td>
<td>
<div class="imagebutton" id="insertunorderedlist"><img class="image" src="newedit_files/unorderedlist.gif" alt="Unordered List" title="Unordered List"></div>
</td>
<td>
</td>
<td>
<div class="imagebuttonClick" id="outdent"><img class="image" src="newedit_files/outdent.gif" alt="Outdent" title="Outdent"></div>
</td>

<td>
<div class="imagebuttonClick" id="indent"><img class="image" src="newedit_files/indent.gif" alt="Indent" title="Indent"></div>
</td>


<!--
<td>
</td>

<td>
<div class="imagebutton" id="createtable"><img class="image" src="newedit_files/table.gif" alt="Insert Table" title="Insert Table" style="left: 1px; top: 1px;"></div>
</td>
-->

</tr>
</tbody>
</table>

<table height="90%" width="98%" border="0"  cellpadding="4" cellspacing="0" > 
<tr>

<td valign="top" width="21" id="toolbar2" style="visibility: visible">


<div class="imagebuttonClick" id="cut"><img class="image" src="newedit_files/cut.gif" alt="Cut" title="Cut"></div>
<div class="imagebuttonClick" id="copy"><img class="image" src="newedit_files/copy.gif" alt="Copy" title="Copy"></div>
<div class="imagebuttonClick" id="paste"><img class="image" src="newedit_files/paste.gif" alt="Paste" title="Paste"></div>
<br>
<div class="imagebuttonClick" id="undo"><img class="image" src="newedit_files/undo.gif" alt="Undo" title="Undo" style="left: 1px; top: 1px;"></div>
<div class="imagebuttonClick" id="redo"><img class="image" src="newedit_files/redo.gif" alt="Redo" title="Redo"></div>

<br/>
<div class="imagebuttonClick" id="showImagePicker"><img class="image" src="newedit_files/insertimage.gif" alt="Insert Image" title="Insert Image"></div>

<div class="imagebuttonClick" id="createlink"><img class="image" src="newedit_files/link.gif" alt="Insert Link" title="Insert Link" style="left: 1px; top: 1px;"></div>


</td>

<td>
<iframe  id="editbox" name="editbox" width="100%" height="100%"></iframe>
</td>
</tr>
</table>


<iframe width="250" height="190" id="colorpalette" src="newedit_files/colors.html" style="position: absolute; top: 91px; left: 413px; visibility: hidden;"></iframe>



<input type="checkbox" onclick="viewsource(this.checked)">
HTML Source
<!-- 
<input checked="checked" type="checkbox" onclick="usecss(this.checked)">
Use CSS

<input type="checkbox" onclick="readonly(this.checked)"> 
Read only -->

<form name="contentForm" target="$parentPage" method="post" action="$origURL">
	#foreach( $entry in $editableContent.requiredParameters.entrySet() )
		<input type="hidden" name="$entry.key" value="$entry.value" />
	#end
	<input type="hidden" name="$editableContent.contentParameter"  />
</form>

<textarea id="source" cols="1" rows="1" style="display: none;">$url_util.xmlEscape( $editableContent.content )</textarea>


</body></html>