<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE services PUBLIC "-//OFBiz//DTD Services Config//EN" "http://www.ofbiz.org/dtds/services.dtd">
<services>
	<description>OFBiz Security Services</description>
	<vendor>OFBiz</vendor>
	<version>1.0</version>
    
	<!-- UserLogin services -->
	<service name="userLogin" engine="java" location="org.ofbiz.securityext.login.LoginServices" invoke="userLogin">
		<description>Used to Automatically Authenticate a username/password; create a UserLogin object</description>
		<attribute name="login.username" type="String" mode="IN"/>
		<attribute name="login.password" type="String" mode="IN"/>
		<attribute name="visitId" type="String" mode="IN" optional="true"/>
		<attribute name="isServiceAuth" type="Boolean" mode="IN" optional="true"/>
		<attribute name="userLogin" type="org.ofbiz.entity.GenericValue" mode="OUT"/>
		<attribute name="userLoginSession" type="java.util.Map" mode="OUT" optional="true"/>
	</service>
	<service name="createUserLogin" engine="java" location="org.ofbiz.securityext.login.LoginServices" invoke="createUserLogin" auth="false">
		<description>Create a UserLogin</description>
		<attribute name="userLoginId" type="String" mode="IN" optional="false"/>
		<attribute name="currentPassword" type="String" mode="IN" optional="false"/>
		<attribute name="currentPasswordVerify" type="String" mode="IN" optional="false"/>
		<attribute name="passwordHint" type="String" mode="IN" optional="true"/>
		<attribute name="partyId" type="String" mode="IN" optional="true"/>
	</service>
	<service name="updateUserLoginId" engine="java" location="org.ofbiz.securityext.login.LoginServices" invoke="updateUserLoginId" auth="true">
		<description>Update a UserLoginId by creating a new one and expiring the old one</description>
		<attribute name="userLoginId" type="String" mode="IN" optional="false"/>
		<attribute name="newUserLogin" type="org.ofbiz.entity.GenericValue" mode="OUT" optional="false"/>
	</service>
	<service name="updatePassword" engine="java" location="org.ofbiz.securityext.login.LoginServices" invoke="updatePassword" auth="true">
		<description>Update a UserLogin Password</description>
		<attribute name="userLoginId" type="String" mode="IN" optional="true"/>
		<attribute name="currentPassword" type="String" mode="IN" optional="true"/>
		<attribute name="newPassword" type="String" mode="IN" optional="true"/>
		<attribute name="newPasswordVerify" type="String" mode="IN" optional="true"/>
		<attribute name="passwordHint" type="String" mode="IN" optional="true"/>
		<attribute name="updatedUserLogin" type="org.ofbiz.entity.GenericValue" mode="OUT" optional="false"/>
	</service>
	<service name="updateUserLoginSecurity" engine="java" location="org.ofbiz.securityext.login.LoginServices" invoke="updateUserLoginSecurity" auth="true">
		<description>Update UserLogin Security Settings</description>
		<attribute name="userLoginId" type="String" mode="IN" optional="false"/>
		<attribute name="enabled" type="String" mode="IN" optional="false"/>
		<attribute name="disabledDateTime" type="java.sql.Timestamp" mode="IN" optional="true"/>
		<attribute name="successiveFailedLogins" type="Long" mode="IN" optional="true"/>
	</service>

	<!-- SecurityGroup services -->
	<service name="createSecurityGroup" engine="simple" location="org/ofbiz/securityext/securitygroup/SecurityGroupServices.xml" invoke="createSecurityGroup" auth="true">
		<description>Create an SecurityGroup</description>
		<attribute name="groupId" type="String" mode="IN" optional="false"/>
		<attribute name="description" type="String" mode="IN" optional="false"/>
	</service>
	<service name="updateSecurityGroup" engine="simple" location="org/ofbiz/securityext/securitygroup/SecurityGroupServices.xml" invoke="updateSecurityGroup" auth="true">
		<description>Update a SecurityGroup</description>
		<attribute name="groupId" type="String" mode="IN" optional="false"/>
		<attribute name="description" type="String" mode="IN" optional="false"/>
	</service>
	<!-- SecurityPermission services -->
	<service name="createSecurityPermission" engine="simple" location="org/ofbiz/securityext/securitygroup/SecurityGroupServices.xml" invoke="createSecurityPermission" auth="true">
		<description>Create a SecurityPermission</description>
		<attribute name="permissionId" type="String" mode="IN" optional="false"/>
		<attribute name="description" type="String" mode="IN" optional="false"/>
	</service>
	<service name="updateSecurityPermission" engine="simple" location="org/ofbiz/securityext/securitygroup/SecurityGroupServices.xml" invoke="updateSecurityPermission" auth="true">
		<description>Update a SecurityPermission</description>
		<attribute name="permissionId" type="String" mode="IN" optional="false"/>
		<attribute name="description" type="String" mode="IN" optional="false"/>
	</service>

	<!-- SecurityPermission to SecurityGroup services -->
	<service name="addSecurityPermissionToSecurityGroup" engine="simple" location="org/ofbiz/securityext/securitygroup/SecurityGroupServices.xml" invoke="addSecurityPermissionToSecurityGroup" auth="true">
		<description>Add a SecurityPermission to a SecurityGroup</description>
		<attribute name="groupId" type="String" mode="IN" optional="false"/>
		<attribute name="permissionId" type="String" mode="IN" optional="false"/>
	</service>
	<service name="removeSecurityPermissionFromSecurityGroup" engine="simple" location="org/ofbiz/securityext/securitygroup/SecurityGroupServices.xml" invoke="removeSecurityPermissionFromSecurityGroup" auth="true">
		<description>Remove a SecurityPermission from a SecurityGroup</description>
		<attribute name="groupId" type="String" mode="IN" optional="false"/>
		<attribute name="permissionId" type="String" mode="IN" optional="false"/>
	</service>

	<!-- UserLogin to SecurityGroup services -->
	<service name="addUserLoginToSecurityGroup" engine="simple" location="org/ofbiz/securityext/securitygroup/SecurityGroupServices.xml" invoke="addUserLoginToSecurityGroup" auth="true">
		<description>Add a UserLogin to a SecurityGroup</description>
		<attribute name="userLoginId" type="String" mode="IN" optional="false"/>
		<attribute name="groupId" type="String" mode="IN" optional="false"/>
		<attribute name="fromDate" type="Timestamp" mode="IN" optional="true"/>
		<attribute name="thruDate" type="Timestamp" mode="IN" optional="true"/>
	</service>
	<service name="updateUserLoginToSecurityGroup" engine="simple" location="org/ofbiz/securityext/securitygroup/SecurityGroupServices.xml" invoke="updateUserLoginToSecurityGroup" auth="true">
		<description>Update a UserLogin to SecurityGroup Appl</description>
		<attribute name="userLoginId" type="String" mode="IN" optional="false"/>
		<attribute name="groupId" type="String" mode="IN" optional="false"/>
		<attribute name="fromDate" type="Timestamp" mode="IN" optional="false"/>
		<attribute name="thruDate" type="Timestamp" mode="IN" optional="true"/>
	</service>
	<service name="removeUserLoginFromSecurityGroup" engine="simple" location="org/ofbiz/securityext/securitygroup/SecurityGroupServices.xml" invoke="removeUserLoginFromSecurityGroup" auth="true">
		<description>Remove a UserLogin from a SecurityGroup</description>
		<attribute name="userLoginId" type="String" mode="IN" optional="false"/>
		<attribute name="groupId" type="String" mode="IN" optional="false"/>
		<attribute name="fromDate" type="Timestamp" mode="IN" optional="false"/>
	</service>
</services>
