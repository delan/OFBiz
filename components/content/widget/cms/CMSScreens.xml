<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE screens PUBLIC "-//OFBiz//DTD OFBiz Screen Widget//EN" "http://www.ofbiz.org/dtds/widget-screen.dtd">

<!--
 *  Copyright (c) 2004 The Open For Business Project - www.ofbiz.org
 *
 *  Permission is hereby granted, free of charge, to any person obtaining a
 *  copy of this software and associated documentation files (the "Software"),
 *  to deal in the Software without restriction, including without limitation
 *  the rights to use, copy, modify, merge, publish, distribute, sublicense,
 *  and/or sell copies of the Software, and to permit persons to whom the
 *  Software is furnished to do so, subject to the following conditions:
 *
 *  The above copyright notice and this permission notice shall be included
 *  in all copies or substantial portions of the Software.
 *
 *  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
 *  OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 *  MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
 *  IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY
 *  CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT
 *  OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR
 *  THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 *
 *  $Id: CommonScreens.xml 2951 2004-08-03 16:33:32Z byersa $
-->


<screens>
	<screen name="cmsCommon">
		<section>
		<actions>
		    <script location="component://content/widget/getMenuContext.bsh"/>
		    <set field="headerItem" value="CMS"/>
		</actions>
                  <widgets>
                       <decorator-screen name="main" location="component://content/widget/CommonScreens.xml" >
                         <decorator-section name="body">
                           <include-menu name="cms" location="component://content/webapp/content/cms/CMSMenus.xml" />
                           <decorator-section-include name="body"/>
                          </decorator-section>
                        </decorator-screen>
                  </widgets>
		</section>
	</screen>

	<screen name="CMSContentFind">
		<section>
			<condition>
				<if-has-permission permission="CONTENTMGR" action="UPDATE"/>
			</condition>
		<actions>
		    <script location="component://content/widget/getMenuContext.bsh"/>
                    <set field="title" value="CMS Content Find Page"/>
                    <set field="entityName" value="ContentAssocDataResourceViewFrom"/>
                    <set field="queryString" from-field="result.queryString"/>
                    <set field="viewIndex" from-field="requestParameters.VIEW_INDEX" type="Integer"/>
                    <set field="viewSize" from-field="requestParameters.VIEW_SIZE" type="Integer"/>
                    <set field="menuContext.contentTarget" value="CMSContentFind"/>
		</actions>
                  <widgets>
                       <decorator-screen name="cmsCommon" >
                         <decorator-section name="body">
                           <include-form name="findContent" location="component://content/webapp/content/cms/CMSForms.xml" />
                           <include-form name="listFindContent" location="component://content/webapp/content/cms/CMSForms.xml" />
                          </decorator-section>
                        </decorator-screen>
                  </widgets>
		</section>
	</screen>

	<screen name="CMSContentEdit">
		<section>
			<condition>
				<if-has-permission permission="CONTENTMGR" action="UPDATE"/>
			</condition>
		<actions>
		    <script location="component://content/widget/getMenuContext.bsh"/>
                    <set field="title" value="CMS Content Edit Page"/>
                    <set field="titleProperty" value="PageTitleEditContent"/>
			<entity-one entity-name="Content" value-name="currentValue">
				<field-map field-name="contentId" env-name="parameters.contentId"/>
			</entity-one>
			<entity-one entity-name="ElectronicText" value-name="electronicText">
				<field-map field-name="dataResourceId" env-name="parameters.drDataResourceId"/>
			</entity-one>
			<set field="textData" from-field="electronicText.textData"/>
			<set field="contentId" from-field="currentValue.contentId"/>
			<set field="dataResourceId" from-field="parameters.drDataResourceId"/>
            <set field="rootForumId" value="WebStoreFORUM" />
            <set field="rootForumId2" value="WebStoreCONTENT" />
		    <script location="component://content/widget/cms/featureprep.bsh"/>
            <set field="menuContext.contentTarget" value="CMSContentEdit?contentId=${contentId}&amp;drDataResourceId=${dataResourceId}"/>
		</actions>
                  <widgets>
                       <decorator-screen name="cmsCommon" >
                         <decorator-section name="body">
                    		<platform-specific>
                         		<html>
                             		<html-template location="component://content/webapp/content/cms/CMSContentEdit.ftl"/>
                         		</html>
                    		</platform-specific>
                          </decorator-section>
                        </decorator-screen>
                  </widgets>
		</section>
	</screen>
	
	<screen name="CMSContentAdd">
		<section>
			<condition>
				<if-has-permission permission="CONTENTMGR" action="CREATE"/>
			</condition>
		<actions>
		    <script location="component://content/widget/getMenuContext.bsh"/>
                    <set field="title" value="CMS Content Edit Page"/>
                    <set field="titleProperty" value="PageTitleEditContent"/>
		</actions>
                  <widgets>
                       <decorator-screen name="cmsCommon" >
                         <decorator-section name="body">
                           <include-form name="AddContent" location="component://content/webapp/content/cms/CMSForms.xml" />
                          </decorator-section>
                        </decorator-screen>
                  </widgets>
		</section>
	</screen>
	
	<screen name="EditAddContent">
		<section>
			<condition>
				<if-has-permission permission="CONTENTMGR" action="UPDATE"/>
			</condition>
			<actions>
			    <script location="component://content/widget/getMenuContext.bsh"/>
            	<set field="title" value="CMS Content Edit Page"/>
                <set field="entityOperation" value="_UPDATE"/>
                <set field="targetOperation" value="CONTENT_UPDATE|CONTENT_CREATE|CONTENT_CREATE_SUB"/>
                <set field="requiredRoles" value="_OWNER_|BLOG_AUTHOR|BLOG_EDITOR|BLOG_ADMIN|BLOG_PUBLISHER"/>
                <set field="contentPurposeTypeId" value="ARTICLE"/>
			    <script location="component://content/widget/cms/cmseditaddprep.bsh"/>
			</actions>
	    	<widgets>
                       <decorator-screen name="cmsCommon" >
                         <decorator-section name="body">
                           <include-form name="EditAddContentStuff" location="component://content/webapp/content/cms/CMSForms.xml" />
                          </decorator-section>
                        </decorator-screen>
	    	</widgets>
		</section>
	</screen>
	
	<screen name="AdminSearch">
		<section>
			<condition>
				<if-has-permission permission="CONTENTMGR" action="UPDATE"/>
			</condition>
		<actions>
		    <script location="component://content/widget/getMenuContext.bsh"/>
		    <script location="component://content/widget/cms/advancedsearchprep.bsh"/>
		    <script location="component://content/widget/cms/search.bsh"/>
                    <set field="title" value="CMS Search Page"/>
                    <set field="titleProperty" value="PageTitleSearchContent"/>
		</actions>
                  <widgets>
                       <decorator-screen name="cmsCommon" >
                         <decorator-section name="body">
                    		<platform-specific>
                         		<html>
                             		<html-template location="component://content/webapp/content/cms/AdminSearch.ftl"/>
                         		</html>
                    		</platform-specific>
                           <include-form name="searchList" location="component://content/webapp/content/cms/CMSForms.xml" />
                          </decorator-section>
                        </decorator-screen>
                  </widgets>
		</section>
	</screen>

	
	<screen name="AdminIndex">
		<section>
			<condition>
				<if-has-permission permission="CONTENTMGR" action="UPDATE"/>
			</condition>
		<actions>
		    <script location="component://content/widget/getMenuContext.bsh"/>
                    <set field="title" value="CMS Search Page"/>
                    <set field="titleProperty" value="PageTitleSearchContent"/>
		</actions>
                  <widgets>
                       <decorator-screen name="cmsCommon" >
                         <decorator-section name="body">
                           <include-form name="AdminIndex" location="component://content/webapp/content/cms/CMSForms.xml" />
                           <include-form name="AdminIndexAll" location="component://content/webapp/content/cms/CMSForms.xml" />
                          </decorator-section>
                        </decorator-screen>
                  </widgets>
		</section>
	</screen>
	
	<screen name="CMSSites">
		<section>
			<condition>
				<if-has-permission permission="CONTENTMGR" action="UPDATE"/>
			</condition>
		<actions>
		    <script location="component://content/widget/getMenuContext.bsh"/>
                    <set field="title" value="CMS Search Page"/>
                    <set field="titleProperty" value="PageTitleSearchContent"/>
                    <set field="forumId" from-field="parameters.contentId"/>
                    <set field="defaultSiteId" value="WebStoreFORUM"/>
		    <script location="component://content/widget/cms/userpermprep.bsh"/>
		</actions>
                  <widgets>
                       <decorator-screen name="cmsCommon" >
                         <decorator-section name="body">
                    <platform-specific>
                         <html>
                             <html-template location="component://content/webapp/content/cms/CMSSites.ftl"/>
                         </html>
                    </platform-specific>
                          </decorator-section>
                        </decorator-screen>
                  </widgets>
		</section>
	</screen>


	<screen name="addSubSite">
		<section>
			<condition>
				<if-has-permission permission="CONTENTMGR" action="UPDATE"/>
			</condition>
		<actions>
		    <script location="component://content/widget/getMenuContext.bsh"/>
                    <set field="title" value="Add SubSite"/>
                    <set field="titleProperty" value="PageTitleSearchContent"/>
		</actions>
                  <widgets>
                       <decorator-screen name="cmsCommon" >
                         <decorator-section name="body">
                    <platform-specific>
                         <html>
                             <html-template location="component://content/webapp/content/cms/addSubSite.ftl"/>
                         </html>
                    </platform-specific>
                          </decorator-section>
                        </decorator-screen>
                  </widgets>
		</section>
	</screen>

</screens>

