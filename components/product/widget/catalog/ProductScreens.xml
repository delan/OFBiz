<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE screens PUBLIC "-//OFBiz//DTD OFBiz Screen Widget//EN" "http://www.ofbiz.org/dtds/widget-screen.dtd">

<screens>
	<screen name="CommonProductDecorator">
		<actions>
			<set field="leftbar" value="/templates/leftbar.ftl"/>
			<set field="tabButtonItem" value="EditProduct"/>
			
			<set field="productId" from-field="parameters.productId"/>
			<!-- TODO: if productId is empty, set to the request attribute of productId; do this automatically somehow? ie fill parameters Map with request attributes too? -->
			<entity-one entity-name="Product" value-name="product"/>
		</actions>
		<section>
			<!-- TODO: do check for CATALOG, _VIEW permission -->
			<decorator-screen name="main" location="component://product/widget/catalog/CommonScreens.xml">
				<decorator-section name="body">
					<platform-specific>
						<html><html-template location="component://product/webapp/catalog/product/ProductTabBar.ftl"/></html>
					</platform-specific>

                    <label style="head1">${labelTitle} ${product.internalName} [${uiLabelMap.CommonId}:${productId}]</label>
					
					<!-- TODO: add Create Product and View Product (in ecommerce) links -->
					
					<decorator-section-include name="body"/>
				</decorator-section>
			</decorator-screen>
		</section>
	</screen>
	<screen name="EditProduct">
		<actions>
			<set field="title" value="Edit Product"/>
			<set field="titleProperty" value="PageTitleEditProduct"/>
			<set field="labelTitle" value="${uiLabelMap.ProductProduct}"/>

			<set field="productId" from-field="parameters.productId"/>
			<!-- TODO: if productId is empty, set to the request attribute of productId; do this automatically somehow? ie fill parameters Map with request attributes too? -->
			<entity-one entity-name="Product" value-name="product"/>
		</actions>
		<section>
			<decorator-screen name="CommonProductDecorator">
				<decorator-section name="body">
					<form name="EditProduct" location="component://product/webapp/catalog/product/ProductForms.xml"/>
					
					<!-- include the duplicate product form template -->
					<platform-specific>
						<html><html-template location="component://product/webapp/catalog/product/EditProductDupForm.ftl"/></html>
					</platform-specific>
				</decorator-section>
			</decorator-screen>
		</section>
	</screen>
</screens>

