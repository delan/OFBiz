<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE services PUBLIC "-//OFBiz//DTD Services Config//EN" "http://www.ofbiz.org/dtds/services.dtd">

<services>
    <description>Entity Extension Services</description>
    <vendor>OFBiz</vendor>
    <version>1.0</version>	
    
    <!-- Entity Engine Extension Services -->
    <service name="distributedClearAllEntityCaches" engine="jms" location="serviceMessenger" invoke="clearAllEntityCaches" auth="true">
        <description>Clear All Entity Engine Caches for all Servers listening to the topic</description>
    </service>
    <!-- Below uses Group/HTTP engine 
    <service name="distributedClearAllEntityCaches" engine="group" location="distributedClearAllEntityCaches" invoke=""/>
    -->
    <service name="clearAllEntityCaches" engine="java"
            location="org.ofbiz.entityext.cache.EntityCacheServices" invoke="clearAllEntityCaches" auth="true">
        <description>Clears all values from all Entity Engine caches. By default does not distribute.</description>
        <attribute name="distribute" type="Boolean" mode="IN" optional="true"/>
    </service>

    <service name="distributedClearCacheLineByValue" engine="jms" location="serviceMessenger" invoke="clearCacheLineByValue" auth="true">
        <description>Clear Cache Line by value for all Servers listening to the topic</description>
        <attribute name="value" type="GenericValue" mode="IN" optional="false"/>
    </service>
    <!-- Below uses Group/HTTP engine
    <service name="distributedClearCacheLineByValue" engine="group" location="distributedClearCacheLineByValue" invoke=""/>
    -->
    <service name="clearCacheLineByValue" engine="java"
            location="org.ofbiz.extentity.cache.EntityCacheServices" invoke="clearCacheLine" auth="true">
        <description>Clear Cache Line with a value (GenericValue); this is the preferred method since the all, by primary key and by and caches will be cleared. By default does not distribute.</description>
        <attribute name="value" type="GenericValue" mode="IN" optional="false"/>
        <attribute name="distribute" type="Boolean" mode="IN" optional="true"/>
    </service>

    <service name="distributedClearCacheLineByDummyPK" engine="jms" location="serviceMessenger" invoke="clearCacheLineByDummyPK" auth="true">
        <description>Clear Cache Line by dummyPK for all Servers listening to the topic</description>
        <attribute name="dummyPK" type="GenericEntity" mode="IN" optional="false"/>
    </service>
    <!-- Below uses Group/HTTP engine
    <service name="distributedClearCacheLineByDummyPK" engine="group" location="distributedClearCacheLineByDummyPK" invoke=""/>
    -->
    <service name="clearCacheLineByDummyPK" engine="java"
            location="org.ofbiz.extentity.cache.EntityCacheServices" invoke="clearCacheLine" auth="true">
        <description>Clear Cache Line with a dummyPK (GenericEntity); clears that all cache entry and depending on whether the dummyPK is a primaryKey or not this clears the by primary key cache or the specified entry in the by and cache. By default does not distribute.</description>
        <attribute name="dummyPK" type="GenericEntity" mode="IN" optional="false"/>
        <attribute name="distribute" type="Boolean" mode="IN" optional="true"/>
    </service>
    
    <service name="distributedClearCacheLineByPrimaryKey" engine="jms" location="serviceMessenger" invoke="clearCacheLineByPrimaryKey" auth="true">
        <description>Clear Cache Line by primaryKey for all Servers listening to the topic</description>
        <attribute name="primaryKey" type="GenericPK" mode="IN" optional="false"/>
        <attribute name="distribute" type="Boolean" mode="IN" optional="true"/>
    </service>
    <!-- Below uses Group/HTTP engine
    <service name="distributedClearCacheLineByPrimaryKey" engine="group" location="distributedClearCacheLineByPrimaryKey" invoke=""/>
    -->
    <service name="clearCacheLineByPrimaryKey" engine="java"
            location="org.ofbiz.entityext.cache.EntityCacheServices" invoke="clearCacheLine" auth="true">
        <description>Clear Cache Line with a primaryKey (GenericPK); clears the all and by primary key caches. By default does not distribute.</description>
        <attribute name="primaryKey" type="GenericPK" mode="IN" optional="false"/>
        <attribute name="distribute" type="Boolean" mode="IN" optional="true"/>
    </service>
    
    <!-- HTTP Engine localhost cache clearing (example: duplicate entire block for each server) -->
    <service name="localhostClearAllEntityCaches" engine="http"
            location="http://localhost:8080/webtools/control/httpService" invoke="clearAllEntityCaches">
        <implements service="clearAllEntityCaches"/>
    </service>
    <service name="localhostClearCacheLineByValue" engine="http"
            location="http://localhost:8080/webtools/control/httpService" invoke="clearCacheLineByValue">
        <implements service="clearCacheLineByValue"/>
    </service>
    <service name="localhostClearCacheLineByDummyPK" engine="http"
            location="http://localhost:8080/webtools/control/httpService" invoke="clearCacheLineByDummyPK">
        <implements service="clearCacheLineByDummyPK"/>
    </service>
    <service name="localhostClearCacheLineByPrimaryKey" engine="http"
            location="http://localhost:8080/webtools/control/httpService" invoke="clearCacheLineByPrimaryKey">
        <implements service="clearCacheLineByPrimaryKey"/>
    </service>
    
    <!-- EntitySync Services -->
    <service name="createEntitySync" default-entity-name="EntitySync" engine="simple"
            location="org/ofbiz/entityext/synchronization/EntitySyncServices.xml" invoke="createEntitySync" auth="true">
        <description>Create EntitySync</description>
        <auto-attributes include="pk" mode="OUT" optional="false"/>
        <auto-attributes include="nonpk" mode="IN" optional="true"/>
    </service>
    <service name="updateEntitySync" default-entity-name="EntitySync" engine="simple"
            location="org/ofbiz/entityext/synchronization/EntitySyncServices.xml" invoke="updateEntitySync" auth="true">
        <description>Update EntitySync</description>
        <auto-attributes include="pk" mode="IN" optional="false"/>
        <auto-attributes include="nonpk" mode="IN" optional="true"/>
    </service>
    <service name="createEntitySyncInclude" default-entity-name="EntitySyncInclude" engine="simple"
            location="org/ofbiz/entityext/synchronization/EntitySyncServices.xml" invoke="createEntitySyncInclude" auth="true">
        <description>Create EntitySyncInclude</description>
        <auto-attributes include="pk" mode="IN" optional="false"/>
        <auto-attributes include="nonpk" mode="IN" optional="true"/>
        <override name="applEnumId" optional="false"/>
    </service>
    <service name="updateEntitySyncInclude" default-entity-name="EntitySyncInclude" engine="simple"
            location="org/ofbiz/entityext/synchronization/EntitySyncServices.xml" invoke="updateEntitySyncInclude" auth="true">
        <description>Update EntitySyncInclude</description>
        <auto-attributes include="pk" mode="IN" optional="false"/>
        <auto-attributes include="nonpk" mode="IN" optional="true"/>
    </service>
    <service name="deleteEntitySyncInclude" default-entity-name="EntitySyncInclude" engine="simple"
            location="org/ofbiz/entityext/synchronization/EntitySyncServices.xml" invoke="deleteEntitySyncInclude" auth="true">
        <description>Delete EntitySyncInclude</description>
        <auto-attributes include="pk" mode="IN" optional="false"/>
    </service>
    <service name="updateEntitySyncRunning" engine="simple"
            location="org/ofbiz/entityext/synchronization/EntitySyncServices.xml" invoke="updateEntitySync" auth="true" require-new-transaction="true">
        <description>Update EntitySync while Running</description>
        <implements service="updateEntitySync"/>
    </service>
    <service name="createEntitySyncHistory" default-entity-name="EntitySyncHistory" engine="simple"
            location="org/ofbiz/entityext/synchronization/EntitySyncServices.xml" invoke="createEntitySyncHistory" auth="true" require-new-transaction="true">
        <description>Create EntitySyncHistory</description>
        <auto-attributes include="pk" mode="IN" optional="false"/>
        <auto-attributes include="nonpk" mode="IN" optional="true"/>
    </service>
    <service name="updateEntitySyncHistory" default-entity-name="EntitySyncHistory" engine="simple"
            location="org/ofbiz/entityext/synchronization/EntitySyncServices.xml" invoke="updateEntitySyncHistory" auth="true" require-new-transaction="true">
        <description>Update EntitySyncHistory</description>
        <auto-attributes include="pk" mode="IN" optional="false"/>
        <auto-attributes include="nonpk" mode="IN" optional="true"/>
    </service>

    <!-- Entity Remote Synchronization services -->
    <service name="runEntitySync" engine="java"
            location="org.ofbiz.entityext.synchronization.EntitySyncServices" invoke="runEntitySync" auth="true" require-new-transaction="true" transaction-timout="7200">
        <description>Run Entity Sync</description>
        <attribute name="entitySyncId" type="String" mode="IN" optional="false"/>
    </service>
    <service name="storeEntitySyncData" engine="java"
            location="org.ofbiz.entityext.synchronization.EntitySyncServices" invoke="storeEntitySyncData" auth="true" require-new-transaction="true" transaction-timout="300">
        <description>Run Entity Sync</description>
        <attribute name="entitySyncId" type="String" mode="IN" optional="false"/>
        <attribute name="valuesToStore" type="List" mode="IN" optional="false"/>
        <attribute name="keysToRemove" type="List" mode="IN" optional="false"/>
        <attribute name="numInserted" type="Long" mode="OUT" optional="false"/>
        <attribute name="numUpdated" type="Long" mode="OUT" optional="false"/>
        <attribute name="numNotUpdated" type="Long" mode="OUT" optional="false"/>
        <attribute name="numRemoved" type="Long" mode="OUT" optional="false"/>
        <attribute name="numAlreadyRemoved" type="Long" mode="OUT" optional="false"/>
    </service>
    
    <!-- Services to call store remotely -->
    <service name="remoteStoreEntitySyncDataHttp" engine="http"
            location="http://localhost:8080/webtools/control/httpService" invoke="storeEntitySyncData" auth="true" require-new-transaction="true" transaction-timout="300">
        <description>Run Entity Sync</description>
        <implements service="storeEntitySyncData"/>
    </service>
    <service name="remoteStoreEntitySyncDataRmi" engine="rmi"
            location="rmi://localhost:1099/RMIDispatcher" invoke="storeEntitySyncData" auth="true" require-new-transaction="true" transaction-timout="300">
        <description>Run Entity Sync</description>
        <implements service="storeEntitySyncData"/>
    </service>
</services>
