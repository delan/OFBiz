<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <title>Open For Business JSP Tag Library Guide</title>

</head>
<body>

<h2 align="Center">The Open For Business Project: JSP Tag Library Guide</h2>
<br>Written By: David E. Jones
<br>Email: <a href="mailto:jonesde@ofbiz.org">jonesde@ofbiz.org</a>
<br>Open For Business Site: <a href="http://www.ofbiz.org/">http://www.ofbiz.org</a>
<br>
<A href="http://sf.net/projects/ofbiz"> <IMG src="http://sourceforge.net/sflogo.php?group_id=27173" border="0" alt="SourceForge Logo"></A> 
<br>
Founders and Lead Architects: David E. Jones &amp; Andy Zeneski <br>
Last Updated: January 18, 2003<br>
$Id$ <br>
<hr>
<br>
<h3>Table of Contents</h3>
<ul>
  <li><a href="#Related_Documents">Related Documents</a></li>
  <li><a href="#Introduction">Introduction</a> </li>
  <li><a href="#URL">URL Tags</a> </li>
  <li><a href="#Conditional">Conditional Tags</a> </li>
  <li><a href="#Flow">Flow Control Tags</a> </li>
  <li><a href="#Presentation">Data Presentation Tags</a> </li>
  <li><a href="#Internationalization">Internationalization Tags</a> </li>
  <li><a href="#Service">Service Tags</a> </li>
  <li><a href="#Other">Other Tags</a> </li>
</ul>
<hr>
<h3><a name="#Related_Documents">Related Documents</a></h3>
<ul>
  <li><a href="api/index.html">Core JavaDoc (including Taglib)</a></li>
  <li><a href="control.html">Control Servlet Guide</a></li>
  <li><a href="regions.html">Regions Guide</a></li>
</ul>
<hr>
<h3><a name="Introduction">Introduction</a></h3>
<hr>

<p>The Open For Business JSP Tag Library consists of a set of custom tags that 
make it easier to use other components of the OFBiz Core Framework.</p>

<P>While there are some basic conditional, flow control, i18n and other general 
tags included in the library many of these can be found in other more
generalized tag library like the Jakarta library. They are mainly included here
for convenience and have defaults that are more friendly for use in the OFBiz
framework.</P>

<P>The following table presents a list of the OFBiz tags and some basic
information about them for reference. The rest of the document explains each tag
in detail.</P>

<table cellpadding='2' cellspacing='0' border='1'>
<tr>
    <td><b>Tag&nbsp;Name</b></td>
    <td><b>BodyContent</b></td>
    <td><b>Tag Class</b></td>
    <td><b>TEI Class</b></td>
</tr>
<tr><td>url</td><td>JSP</td><td>UrlTag</td><td>&nbsp;</td></tr>
<tr><td>contenturl</td><td>JSP</td><td>ContentUrlTag</td><td>&nbsp;</td></tr>
<tr><td>if</td><td>JSP</td><td>IfTag</td><td>&nbsp;</td></tr>
<tr><td>unless</td><td>JSP</td><td>UnlessTag</td><td>&nbsp;</td></tr>
<tr><td>iterator</td><td>JSP</td><td>IteratorTag</td><td>IteratorTEI</td></tr>
<tr><td>iteratorNext</td><td>JSP</td><td>IterateNextTag</td><td>IterateNextTEI</td></tr>
<tr><td>iteratorHasNext</td><td>JSP</td><td>IteratorHasNextTag</td><td>&nbsp;</td></tr>
<tr><td>format</td><td>JSP</td><td>FormatTag</td><td>&nbsp;</td></tr>
<tr><td>print</td><td>empty</td><td>PrintTag</td><td>&nbsp;</td></tr>
<tr><td>field</td><td>empty</td><td>EntityFieldTag</td><td>&nbsp;</td></tr>
<tr><td>entityfield</td><td>empty</td><td>EntityFieldTag</td><td>&nbsp;</td></tr>
<tr><td>inputvalue</td><td>empty</td><td>InputValueTag</td><td>&nbsp;</td></tr>
<tr><td>i18nBundle</td><td>JSP</td><td>I18nBundleTag</td><td>&nbsp;</td></tr>
<tr><td>i18nMessage</td><td>JSP</td><td>I18nMessageTag</td><td>&nbsp;</td></tr>
<tr><td>i18nMessageArgument</td><td>empty</td><td>I18nMessageArgumentTag</td><td>&nbsp;</td></tr>
<tr><td>service</td><td>JSP</td><td>ServiceTag</td><td>&nbsp;</td></tr>
<tr><td>param</td><td>empty</td><td>ParamTag</td><td>&nbsp;</td></tr>
<tr><td>object</td><td>JSP</td><td>ObjectTag</td><td>ObjectTEI</td></tr>
</table>

<br>
<hr>
<h3><a name="URL">URL Tags</a></h3>
<hr>

<P><B><U>ofbiz:url</U></B></P>

<P>Add control path and URL encode if necessary. This is for links to dynamic 
pages in the same webapp and the body is meant to contain a forward slash ("/")
and then the name of a request defined in the controller.xml file. Parameters
should also be included inside the tag.</P>

<P>The tag will automatically insert the mounting point of the current webapp
and the mounting point of the control servlet.</P>

<P>The tag will also create a secure (HTTPS) URL (a URL that refers to the secure port on the
server) to automatically go from insecure to secure areas, and will create an
plain or non-secure (HTTP) URL to automatically go from secure to insecure areas of the
site. This is configured in the url.properties file. See the Core Configuration
Guide for more details.</P>

<P>This tag has no attributes.</P>

<P><B><U>ofbiz:contenturl</U></B></P>

<P>Builds a URL for content referred to by this page. This is generally for 
static content such as images that can be stored on a different server. So, if 
necessary it will create a complete URL for the static content and is takes into
account whether the content should be referred to securely (with HTTPS) or not
(with HTTP).</P>

<P>This is also configured in the url.properties file as described in the Core
Configuration Guide.</P>

<P>This tag has no attributes.</P>

<hr>
<h3><a name="Conditional">Conditional Tags</a></h3>
<hr>

<P><B><U>ofbiz:if</U></B></P>

<P>Processes the body content of the tag if the named attribute value exists
and if it meets any size and value conditions specified.</P>

<table cellpadding='2' cellspacing='0' border='1'>
<tr>
    <td><b>Attribute&nbsp;Name</b></td>
    <td><b>Required?</b></td>
    <td><b>ExprVal?</b></td>
    <td><b>Description</b></td>
</tr>
<tr>
    <td>name</td><td>Y</td><td>Y</td>
    <td>The name of the page, request, session, or application attribute to use
    for the comparison.</td>
</tr>
<tr>
    <td>type</td><td>N</td><td>N</td>
    <td>The type of the attribute Object. It is not necessary to specify this
    because the tag will test the type of the object at runtime. Only necessary
    if the default behavior does not behave as desired.</td>
</tr>
<tr>
    <td>value</td><td>N</td><td>Y</td>
    <td>If specified the named attribute value will be compared to this value.
    Can be specified using the <code>&lt;%=...%&gt;</code> syntax to refer to
    an existing object declared within the JSP.</td>
</tr>
<tr>
    <td>size</td><td>N</td><td>N</td>
    <td>If specified this value will be compared to the size of the named
    attribute value. This is mostly applicable for type such as Collections,
    Maps, Strings, etc.</td>
</tr>
</table>

<P><B><U>ofbiz:unless</U></B></P>

<P>Does the exact opposite of the if tag. In other words the body content will
be evaluated if the named attribute value does not exist or if it does exist
but does not meet the size and value conditions.</p>

<P>The attributes of the unless tag are the same as the attributes of the if
tag. Refer to the table above in the if tag section for detailed information
on these attributes.</p>

<hr>
<h3><a name="Flow">Flow Control Tags</a></h3>
<hr>

<P><B><U>ofbiz:iterator</U></B></P>

<P>The iterator tag iterates over a collection of elements in a collection
object in a named attribute. The individual elements are placed in a
pageContext attribute, and made available in the JSP Java context for use in
scriptlets.</P>

<table cellpadding='2' cellspacing='0' border='1'>
<tr>
    <td><b>Attribute&nbsp;Name</b></td>
    <td><b>Required?</b></td>
    <td><b>ExprVal?</b></td>
    <td><b>Description</b></td>
</tr>
<tr>
    <td>name</td><td>Y</td><td>N</td>
    <td>The name of the attribute that the collection of elements will come
    from. Can be in the page, request, session or application contexts.</td>
</tr>
<tr>
    <td>property</td><td>N</td><td>N</td>
    <td>The name of the attribute and Java variable that the individual elements
    will be put into as the iterator iterates.</td>
</tr>
<tr>
    <td>type</td><td>N</td><td>N</td>
    <td>The type of the elements within the collections. This must be specified
    so that the Java context variable can be created. Defaults to
    org.ofbiz.core.entity.GenericValue, which is one of the more common objects
    to iterate over in OFBiz framework based applications.</td>
</tr>
<tr>
    <td>expandMap</td><td>N</td><td>N</td>
    <td>If expandMap is true then the iterator elements must implement
    the Map interface the the keys in the Map entries must be Strings.
    Each map entry will be put into the pageContext if this is set using the
    Map key value as the attribute name.
    Must be true or false. Defaults to false.</td>
</tr>
<tr>
    <td>offset</td><td>N</td><td>Y</td>
    <td>If specified the iteration will start at the given offset index instead
    of at the beginning of the collection.</td>
</tr>
<tr>
    <td>limit</td><td>N</td><td>Y</td>
    <td>If specified only the specified number of iterations will be done. In
    other words this limits the number of elements pulled from the iterator.</td>
</tr>
</table>
<br>
<table cellpadding='2' cellspacing='0' border='1'>
<tr>
    <td><b>Sub-Element&nbsp;Name</b></td>
    <td><b>How&nbsp;Many</b></td>
    <td><b>Description</b></td>
</tr>
<tr>
    <td>iterateNext</td><td>0 to many</td>
    <td>Descibed below.</td>
</tr>
<tr>
    <td>iteratorHasNext</td><td>0 to many</td>
    <td>Descibed below.</td>
</tr>
</table>

<P><B><U>ofbiz:iteratorNext</U></B></P>

<P>Grab the next element in the collection of the parent iterator tag.</P>

<table cellpadding='2' cellspacing='0' border='1'>
<tr>
    <td><b>Attribute&nbsp;Name</b></td>
    <td><b>Required?</b></td>
    <td><b>ExprVal?</b></td>
    <td><b>Description</b></td>
</tr>
<tr>
    <td>name</td><td>N</td><td>N</td>
    <td>The name of the attribute to put the element in. Defaults to the name
    specified in the property attribute of the parent iterator tag.</td>
</tr>
<tr>
    <td>type</td><td>N</td><td>N</td>
    <td>The type of the elements within the collections. This must be specified
    so that the Java context variable can be created. Defaults to
    org.ofbiz.core.entity.GenericValue, which is one of the more common objects
    to iterate over in OFBiz framework based applications.</td>
</tr>
<tr>
    <td>expandMap</td><td>N</td><td>N</td>
    <td>If expandMap is true then the iterator elements must implement
    the Map interface the the keys in the Map entries must be Strings.
    Each map entry will be put into the pageContext if this is set using the
    Map key value as the attribute name.
    Must be true or false. Defaults to false.</td>
</tr>
</table>

<P><B><U>ofbiz:iteratorHasNext</U></B></P>

<P>Only process body if parent iterator tag has another entry.</P>

<P>This tag has no attributes.</P>

<hr>
<h3><a name="Presentation">Data Presentation Tags</a></h3>
<hr>

<P><B><U>ofbiz:format</U></B></P>

<P>Formats dates, numbers and currencies from the value in the body of the
tag. It has one attribute that specifies how the text should be formatted.</P>

<table cellpadding='2' cellspacing='0' border='1'>
<tr>
    <td><b>Attribute&nbsp;Name</b></td>
    <td><b>Required?</b></td>
    <td><b>ExprVal?</b></td>
    <td><b>Description</b></td>
</tr>
<tr>
    <td>type</td><td>N</td><td>N</td>
    <td>Specified how the type of format to apply to the body value. Must be
    "currency", "number", or "date". If not type is specified the original value
    is printed.</td>
</tr>
</table>

<P><B><U>ofbiz:print</U></B></P>

<P>Prints an attribute from the pageContext. If null prints the default value
or nothing if no default is specified.</P>

<table cellpadding='2' cellspacing='0' border='1'>
<tr>
    <td><b>Attribute&nbsp;Name</b></td>
    <td><b>Required?</b></td>
    <td><b>ExprVal?</b></td>
    <td><b>Description</b></td>
</tr>
<tr>
    <td>attribute</td><td>Y</td><td>Y</td>
    <td>The name of the attribute to print.</td>
</tr>
<tr>
    <td>default</td><td>N</td><td>Y</td>
    <td>The default value to print if the specified attribute is not found.</td>
</tr>
</table>

<P><B><U>ofbiz:field</U></B></P>

<P>Displays a properly formatted string from field in the specified
attribute.</P>

<table cellpadding='2' cellspacing='0' border='1'>
<tr>
    <td><b>Attribute&nbsp;Name</b></td>
    <td><b>Required?</b></td>
    <td><b>ExprVal?</b></td>
    <td><b>Description</b></td>
</tr>
<tr>
    <td>attribute</td><td>Y</td><td>N</td>
    <td>The name of the attribute that contains the field to print.</td>
</tr>
<tr>
    <td>type</td><td>N</td><td>N</td>
    <td>Optionally specifies the type of the field to print. Can be "currency"
    or any of the Java field types. If not specified the tag will automatically
    determine the Java type.</td>
</tr>
<tr>
    <td>default</td><td>N</td><td>Y</td>
    <td>The default value to print if the specified field is not found.</td>
</tr>
<tr>
    <td>prefix</td><td>N</td><td>N</td>
    <td>If the resulting message is not empty this string will be printed before
    the field value.</td>
</tr>
<tr>
    <td>suffix</td><td>N</td><td>N</td>
    <td>If the resulting message is not empty this string will be printed after
    the field value.</td>
</tr>
</table>

<P><B><U>ofbiz:entityfield</U></B></P>

<P>Displays a properly formatted localized string from a field in the entity in 
the specified attribute. The prefix and suffix attribute contents will print 
before/after if the field is not null or empty.</P>

<table cellpadding='2' cellspacing='0' border='1'>
<tr>
    <td><b>Attribute&nbsp;Name</b></td>
    <td><b>Required?</b></td>
    <td><b>ExprVal?</b></td>
    <td><b>Description</b></td>
</tr>
<tr>
    <td>attribute</td><td>Y</td><td>N</td>
    <td>The name of the attribute that contains the entity that contains the 
    field to print.</td>
</tr>
<tr>
    <td>field</td><td>Y</td><td>N</td>
    <td>The name of the field to print in the named entity.</td>
</tr>
<tr>
    <td>type</td><td>N</td><td>N</td>
    <td>Optionally specifies the type of the field to print. Can be "currency"
    or any of the Java field types. If not specified the tag will automatically
    determine the Java type AND get additional type information from the Entity
    Engine field definition for this field. With that information currency will
    automatically be formatted as currency.</td>
</tr>
<tr>
    <td>default</td><td>N</td><td>Y</td>
    <td>The default value to print if the specified field is not found.</td>
</tr>
<tr>
    <td>prefix</td><td>N</td><td>N</td>
    <td>If the resulting message is not empty this string will be printed before
    the field value.</td>
</tr>
<tr>
    <td>suffix</td><td>N</td><td>N</td>
    <td>If the resulting message is not empty this string will be printed after
    the field value.</td>
</tr>
</table>

<P><B><U>ofbiz:inputvalue</U></B></P>

<P>Outputs a string for an input box from either an entity field or a request 
parameter. Decides which to use by checking to see if the entityAttr exists and 
using the specified field if it does.</P>

<P>If the Boolean object referred to by the tryEntityAttr attribute is false, 
always tries to use the request parameter and ignores the entity field.</P>

<P>Formatting is done with a very simple toString.</P>

<P>The Object found by looking up the context attribute with the name specified
by entityAttr can be either a GenericValue object, or any implementation of the
Map interface.</P>

<table cellpadding='2' cellspacing='0' border='1'>
<tr>
    <td><b>Attribute&nbsp;Name</b></td>
    <td><b>Required?</b></td>
    <td><b>ExprVal?</b></td>
    <td><b>Description</b></td>
</tr>
<tr>
    <td>field</td><td>Y</td><td>N</td>
    <td>The name of the field to print in the named entity.</td>
</tr>
<tr>
    <td>param</td><td>N</td><td>N</td>
    <td>The name of the URL parameter that corresponds to this value. If null or 
    empty param will be the same as field.</td>
</tr>
<tr>
    <td>entityAttr</td><td>Y</td><td>N</td>
    <td>The name of the attribute that contains the entity that contains the 
    field to print.</td>
</tr>
<tr>
    <td>tryEntityAttr</td><td>Y</td><td>N</td>
    <td>The name of an context attribute that contains a Boolean which specifies
    whether or not to even try using the named entity. If false the request
    parameter value will be used, if true the entity field value will be used.</td>
</tr>
<tr>
    <td>default</td><td>N</td><td>Y</td>
    <td>The default value to print if the specified entity field or parameter is 
    not found.</td>
</tr>
<tr>
    <td>fullattrs</td><td>N</td><td>N</td>
    <td>If fullattrs is set to true then [name="{param}" value="{value}"] will be 
    output instead of just [value]. By default fullattrs is false.</td>
</tr>
</table>

<br>
<hr>
<h3><a name="Internationalization">Internationalization Tags</a></h3>
<hr>

<P><B><U>ofbiz:i18nBundle</U></B></P>

<P>Used to specify and load an internationalized message bundle. The bundle will
be referred to by the id attribute value if specified. By default all messages
will be retreived from the bundle specified by their parent i18nBundle tag, in
other words the i18nMessage tags will be nested inside the bundle tag.</P>

<table cellpadding='2' cellspacing='0' border='1'>
<tr>
    <td><b>Attribute&nbsp;Name</b></td>
    <td><b>Required?</b></td>
    <td><b>ExprVal?</b></td>
    <td><b>Description</b></td>
</tr>
<tr>
    <td>id</td><td>N</td><td>Y</td>
    <td>An ID that can be used later in the bundleId attribute of the 
    i18nMessage tag to refer to this bundle.</td>
</tr>
<tr>
    <td>baseName</td><td>Y</td><td>Y</td>
    <td>The resource base name of the message bundle. Generally the name of a
    .properties file, but specified without the .properties extension.</td>
</tr>
</table>

<P><B><U>ofbiz:i18nMessage</U></B></P>

<P>Prints an internationalized message from the parent or specified bundle
identified by the given key. Accepts message arguments using nested
i18nMessageArgument tags.</P>

<table cellpadding='2' cellspacing='0' border='1'>
<tr>
    <td><b>Attribute&nbsp;Name</b></td>
    <td><b>Required?</b></td>
    <td><b>ExprVal?</b></td>
    <td><b>Description</b></td>
</tr>
<tr>
    <td>key</td><td>Y</td><td>Y</td>
    <td>The key or ID of the message within the bundle.</td>
</tr>
<tr>
    <td>bundleId</td><td>N</td><td>Y</td>
    <td>The ID of the bundle to get the message from. If not specified looks for
    the parent i18nBundle tag and uses that bundle.</td>
</tr>
</table>

<P><B><U>ofbiz:i18nMessageArgument</U></B></P>

<P>Specifies an agrument for the parent i18nMessage tag. The arguments will be
numbered in the order they are specified.</P>

<table cellpadding='2' cellspacing='0' border='1'>
<tr>
    <td><b>Attribute&nbsp;Name</b></td>
    <td><b>Required?</b></td>
    <td><b>ExprVal?</b></td>
    <td><b>Description</b></td>
</tr>
<tr>
    <td>value</td><td>Y</td><td>Y</td>
    <td>The value of the argument to insert into the message. Can use the
    <code>&lt;%=...%&gt;</code> syntax to use Java method context variables.</td>
</tr>
</table>

<br>
<hr>
<h3><a name="Service">Service Tags</a></h3>
<hr>

<P><B><U>ofbiz:service</U></B></P>

<P>The service tag invokes the named service using the given mode (sync or
async). The results can be placed in the page, request, session or application
scope as specified using the resultTo attribute. The default scope is page.</P>

<P>To specify information about parameters and return values use nested param
tags. They are described below.</P>

<P>For more information on services see the Service Engine Guide and the Service
Engine Configuration Guide.</P>

<table cellpadding='2' cellspacing='0' border='1'>
<tr>
    <td><b>Attribute&nbsp;Name</b></td>
    <td><b>Required?</b></td>
    <td><b>ExprVal?</b></td>
    <td><b>Description</b></td>
</tr>
<tr>
    <td>name</td><td>Y</td><td>Y</td>
    <td>The name of the service to call.</td>
</tr>
<tr>
    <td>mode</td><td>N</td><td>Y</td>
    <td>The mode that will be used to call the service, either synchronous or
    asynchronous. Must be sync or async, Defaults to sync.</td>
</tr>
<tr>
    <td>resultTo</td><td>N</td><td>Y</td>
    <td>Specifies the scope that the results should be put into. The OUT
    attributes/parameters of the service will be put into attributes in this
    scope. Must be page, request, session or application. Defaults to page.</td>
</tr>
</table>

<P><B><U>ofbiz:param</U></B></P>

<P>The param tag is used to specify information about parameters passed to the
service and can also be used for spcifying certain information about return
values.</P>

<table cellpadding='2' cellspacing='0' border='1'>
<tr>
    <td><b>Attribute&nbsp;Name</b></td>
    <td><b>Required?</b></td>
    <td><b>ExprVal?</b></td>
    <td><b>Description</b></td>
</tr>
<tr>
    <td>name</td><td>Y</td><td>Y</td>
    <td>The name of the service parameter.</td>
</tr>
<tr>
    <td>value</td><td>N</td><td>Y</td>
    <td>The value to assign to an IN parameter. Can use the
    <code>&lt;%=...%&gt;</code> syntax to use Java method context variables.</td>
</tr>
<tr>
    <td>mode</td><td>N</td><td>Y</td>
    <td>Specifies the mode of the parameter. Must be IN, OUT or INOUT. Defaults
    to IN. If OUT or INOUT the alias attribute can be used to override the 
    default key for the context attribute in the scope specified in the
    service tag.</td>
</tr>
<tr>
    <td>map</td><td>N</td><td>Y</td>
    <td>Specifies a name for a Map to find in a context attribute. If specified
    the attribute attribute will be used to find a value in this map. If not
    specified the attribute attribute will be used to lookup a value in a
    context attribute.</td>
</tr>
<tr>
    <td>attribute</td><td>N</td><td>Y</td>
    <td>Specifies the name of the attribute value to lookup. This is used
    INSTEAD of the value attribute which is used to directly specify the value
    to be passed to the service for this parameter. The looked up attribute
    value will be passed to the service for this parameter.</td>
</tr>
<tr>
    <td>alias</td><td>N</td><td>Y</td>
    <td>Used to specify the key that will be used when putting OUT or INOUT
    parameters into a context attribute. Defaults to the value of the name
    attribute.</td>
</tr>
</table>

<br>
<hr>
<h3><a name="Other">Other Tags</a></h3>
<hr>

<P><B><U>ofbiz:object</U></B></P>

<P>Makes an Object in a context attribute (page, request, session or
application) available in the Java method context of the JSP so it can be used
in Java scriptlets, etc.</P>

<table cellpadding='2' cellspacing='0' border='1'>
<tr>
    <td><b>Attribute&nbsp;Name</b></td>
    <td><b>Required?</b></td>
    <td><b>ExprVal?</b></td>
    <td><b>Description</b></td>
</tr>
<tr>
    <td>name</td><td>Y</td><td>N</td>
    <td>The name of the Java method context variable to create.</td>
</tr>
<tr>
    <td>property</td><td>N</td><td>N</td>
    <td>The name of the context attribute to attach the value to. If not
    specified will be the same as name.</td>
</tr>
<tr>
    <td>type</td><td>N</td><td>N</td>
    <td>The Java type of the object. If not specified defaults to
    org.ofbiz.core.entity.GenericValue.</td>
</tr>
</table>

</body>
</html>
